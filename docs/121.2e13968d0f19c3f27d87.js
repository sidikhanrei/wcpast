(self.webpackChunkwachatpro_webclient=self.webpackChunkwachatpro_webclient||[]).push([[121],{58353:(e,t,i)=>{"use strict";i.d(t,{EB:()=>r});var o=i(39895),s=i(44875),a=(i(67926),i(37716));const n=[{path:"",children:[{path:"",component:s.L}]}];let r=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({imports:[[o.Bz.forChild(n)],o.Bz]}),e})()},44875:(e,t,i)=>{"use strict";i.d(t,{L:()=>J});var o=i(67926),s=i(16738),a=i.n(s),n=i(23815),r=i.n(n),l=i(37716),c=i(42448),d=i(22238),f=i(71386),m=i(38583),h=i(76627),g=i(51095),p=i(45396),u=i(3679),x=i(29790);function Z(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",12),l._UZ(1,"mat-icon",13),l.TgZ(2,"div",14),l.TgZ(3,"div"),l._uU(4),l.ALo(5,"translate"),l.qZA(),l.TgZ(6,"div",15),l._uU(7),l.ALo(8,"translate"),l.qZA(),l.qZA(),l.TgZ(9,"button",16),l.NdJ("click",function(){return l.CHM(e),l.oxw().openDialog()}),l._UZ(10,"mat-icon",17),l._uU(11),l.ALo(12,"translate"),l.qZA(),l.qZA()}if(2&e){const e=l.oxw();l.xp6(4),l.hij(" ",l.lcZ(5,4,"ar.empty.title")," "),l.xp6(3),l.hij(" ",l.lcZ(8,6,"ar.empty.desc")," "),l.xp6(2),l.Q6J("disabled",e.Busy),l.xp6(2),l.hij(" ",l.lcZ(12,8,"ar.button.create")," ")}}function _(e,t){if(1&e&&(l.TgZ(0,"div",42),l._uU(1),l.ALo(2,"uppercase"),l.qZA()),2&e){const e=l.oxw().$implicit;l.xp6(1),l.hij(" ",l.lcZ(2,1,e.insid)," ")}}function v(e,t){if(1&e&&(l.TgZ(0,"div"),l._uU(1),l.qZA()),2&e){const e=l.oxw().$implicit;l.xp6(1),l.hij(" ",e.alias," ")}}function b(e,t){if(1&e&&(l.TgZ(0,"div"),l._uU(1),l.TgZ(2,"span",43),l._uU(3),l.qZA(),l.qZA()),2&e){const e=l.oxw().$implicit;l.xp6(1),l.hij(" ",null==e.info?null:e.info.pushname," - "),l.xp6(2),l.hij(" ",null==e.info||null==e.info.me?null:e.info.me.user," ")}}function y(e,t){if(1&e&&(l.TgZ(0,"div",46),l._uU(1),l.qZA()),2&e){const e=t.$implicit;l.xp6(1),l.hij(" ",e," ")}}function A(e,t){if(1&e&&(l.TgZ(0,"div",44),l.YNc(1,y,2,1,"div",45),l.qZA()),2&e){const e=l.oxw().$implicit;l.xp6(1),l.Q6J("ngForOf",e.rcv_message_array)}}function q(e,t){1&e&&(l.TgZ(0,"div",44),l.TgZ(1,"div",47),l._uU(2),l.ALo(3,"translate"),l.qZA(),l.qZA()),2&e&&(l.xp6(2),l.hij(" ",l.lcZ(3,1,"ar.form.operator.v3")," "))}function w(e,t){if(1&e){const e=l.EpF();l.ynx(0),l.TgZ(1,"div",25),l.TgZ(2,"mat-slide-toggle",26),l.NdJ("ngModelChange",function(t){return l.CHM(e).$implicit.aktif=t})("toggleChange",function(){const t=l.CHM(e).$implicit;return l.oxw(2).updateAktif(t)}),l.qZA(),l.TgZ(3,"div",27),l.TgZ(4,"div",28),l.TgZ(5,"div",29),l.YNc(6,_,3,3,"div",30),l.YNc(7,v,2,1,"div",31),l.YNc(8,b,4,2,"div",31),l.qZA(),l.qZA(),l._UZ(9,"div",32),l.TgZ(10,"div",33),l.YNc(11,A,2,1,"div",34),l.YNc(12,q,4,3,"div",34),l.qZA(),l._UZ(13,"div",32),l.TgZ(14,"div",35),l._UZ(15,"div",36),l.qZA(),l.qZA(),l.TgZ(16,"div",37),l.TgZ(17,"div",38),l.TgZ(18,"button",39),l.NdJ("click",function(){const t=l.CHM(e).$implicit;return l.oxw(2).openDialog(t)}),l.TgZ(19,"span",40),l._UZ(20,"mat-icon",41),l.TgZ(21,"span"),l._uU(22," View Detail "),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.BQk()}if(2&e){const e=t.$implicit,i=t.index,o=l.oxw(2);l.xp6(2),l.MGl("name","akif-",i,""),l.Q6J("ngModel",e.aktif),l.xp6(4),l.Q6J("ngIf",!(e.alias||null!=e.info&&e.info.pushname)),l.xp6(1),l.Q6J("ngIf",e.alias&&!(null!=e.info&&e.info.pushname)),l.xp6(1),l.Q6J("ngIf",null==e.info?null:e.info.pushname),l.xp6(3),l.Q6J("ngIf",3!=e.operator),l.xp6(1),l.Q6J("ngIf",3==e.operator),l.xp6(3),l.Q6J("innerHTML",o.toHtml(e.reply),l.oJD)}}function T(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",18),l.TgZ(1,"div",19),l.TgZ(2,"div"),l.TgZ(3,"button",20),l.NdJ("click",function(){return l.CHM(e),l.oxw().openDialog()}),l._UZ(4,"mat-icon",17),l._uU(5),l.ALo(6,"translate"),l.qZA(),l.TgZ(7,"button",21),l.NdJ("click",function(){return l.CHM(e),l.oxw().Refresh()}),l._UZ(8,"mat-icon",22),l._uU(9," Refresh Data "),l.qZA(),l.qZA(),l.qZA(),l.TgZ(10,"div",23),l.YNc(11,w,23,8,"ng-container",24),l.qZA(),l.qZA()}if(2&e){const e=l.oxw();l.xp6(3),l.Q6J("disabled",e.Busy),l.xp6(2),l.hij(" ",l.lcZ(6,4,"ar.button.create")," "),l.xp6(2),l.Q6J("disabled",e.Busy),l.xp6(4),l.Q6J("ngForOf",e.List)}}let J=(()=>{class e{constructor(e,t,i){this.core=e,this.dialog=t,this.zone=i,this.AllList={},this.List=[],this.Busy=!1,this.Com={url:{def:"e/autoreply/",instance:"e/instance/"}},this.Name={def:"ar-list",instance:"inst-list"},this.Preq={},this.DataExpired=3600,this.domList=99}ngOnInit(){this.core.setTitle("Autoreply"),this.loadInstance(()=>{this.loadData()})}Refresh(){this.List=[],this.loadData(!0)}loadData(e=!1){this.Busy||(this.Busy=!0,clearTimeout(this.delayLoadData),this.delayLoadData=setTimeout(()=>{let t=this.Name.def;this.AllList[t]||(this.AllList[t]=[]),e?this.execLoadData(e):this.core.getStorage({id:t,isjson:!0}).then(t=>{var i;if(t){var o=t.data,s=a()(t.stamp);a()(new Date).diff(s,"seconds")>this.DataExpired&&(null===(i=this.List)||void 0===i?void 0:i.length)<=0?this.execLoadData(e):this.zone.run(()=>{if(this.Preq.instance.length>0)for(let i of o)if(!i.info){let e=r().find(this.Preq.instance,{insid:i.insid});e&&e.info&&(i.info=e.info)}let e=JSON.parse(JSON.stringify(o.slice(this.List.length,this.List.length+this.domList)));for(let i of e)if(i.rcv_message)try{i.rcv_message_array=i.rcv_message.split(",")}catch(t){i.rcv_message_array=[i.rcv_message]}this.List=this.List.length>0?[...this.List,...e]:e,e.length<this.domList&&(this.InfiniteStop=!0),this.List.length<=0&&e.length<=0&&(this.DataUnavailable=!0),this.Busy=!1})}else this.execLoadData(e)})},100))}execLoadData(e){clearTimeout(this.delayLoadData),this.delayLoadData=setTimeout(()=>{this.core.Do(this.Com.url.def+"data",{}).subscribe(t=>{this.Busy=!1,t&&t.data?this.zone.run(()=>{let i=t.data;if(this.Preq.instance.length>0)for(let e of i)if(!e.info){let t=r().find(this.Preq.instance,{insid:e.insid});t&&t.info&&(e.info=t.info)}let o=JSON.parse(JSON.stringify(i.slice(0,this.domList)));for(let e of o)if(e.rcv_message)try{e.rcv_message_array=e.rcv_message.split(",")}catch(s){e.rcv_message_array=[e.rcv_message]}this.List=this.List.length>0?[...this.List,...o]:o,o.length<this.domList&&(this.InfiniteStop=!0),o.length<=0&&(this.DataUnavailable=!0),e?(this.AllList[this.Name.def]=[],this.core.removeStorage(this.Name.def).then(()=>{this.updateStorage(i,this.Name.def)})):this.updateStorage(i,this.Name.def)}):(this.InfiniteStop=!0,this.List.length<=0&&(this.DataUnavailable=!0))},e=>{this.Busy=!1})})}updateStorage(e,t=this.Name.def,i=null){this.AllList[t]||(this.AllList[t]=[]),this.core.getStorage({id:t,isjson:!0}).then(o=>{var s;if(o){var n=o.data,r=a()(o.stamp);if(a()(new Date).diff(r,"seconds")>this.DataExpired&&(null===(s=this.List)||void 0===s?void 0:s.length)>0)this.core.setStorage({id:t,isjson:!0},{data:e,stamp:a()(new Date)}).then(()=>{i&&i()});else{var l=[...n,...e];this.AllList[t]=l,this.core.setStorage({id:t,isjson:!0},{data:l,stamp:r}).then(()=>{i&&i()})}}else this.core.setStorage({id:t,isjson:!0},{data:e,stamp:a()(new Date)}).then(()=>{i&&i()}),this.AllList[t]=e})}loadInstance(e){this.core.getStorage({id:this.Name.instance,isjson:!0}).then(t=>{if(t)if(t.data){var i=[];for(let e of t.data)if("demo"!=e.insid){if(e.info)try{e.info=JSON.parse(e.info)}catch(o){}i.push(e)}this.Preq.instance=i,e&&e()}else this.execLoadInstance(e);else this.execLoadInstance(e)})}execLoadInstance(e){if(this.Busy)return!1;this.Busy=!0,this.core.Do(this.Com.url.instance+"data",{}).subscribe(t=>{if(t&&t.data){var i={data:t.data,stamp:a()(new Date)};this.core.setStorage({id:this.Name.instance,isjson:!0},i).then(()=>{var i=[];for(let e of t.data)t.data.length>1&&"demo"==e.insid||(e.info&&(e.info=JSON.parse(e.info)),i.push(e));this.Preq.instance=i,this.Busy=!1,e&&e()})}else this.Busy=!1,e&&e()},t=>{this.Busy=!1,e&&e()})}openDialog(e={}){const t=this.dialog.open(o.T,{disableClose:!0,panelClass:"event-form-dialog"});if(t.componentInstance.Preq=this.Preq,t.componentInstance.Com=this.Com,t.componentInstance.Name=this.Name,e.id){let i=JSON.parse(JSON.stringify(e));i.instance=e.insid,i.is_detail=!0,t.componentInstance.form=i}t.afterClosed().subscribe(e=>{e&&1==e.status&&this.Refresh()})}text2html(e){return this.core.text2html(e)}toHtml(e){if(e)return e.replace(/(?:\\[rn])+/g," ")}updateAktif(e){this.Busy||(this.core.ShowLoader(),setTimeout(()=>{let t;t=e.aktif?1:0;var i={id:e.id,aktif:t};this.Busy=!0,this.core.Do(this.Com.url.def+"aktif",i).subscribe(e=>{e&&1==e.status?this.core.setStorage({id:this.Name.def,isjson:!0},{data:e.data,stamp:a()(new Date)}).then(()=>{this.Busy=!1,this.loadData()}):this.Busy=!1},e=>{this.Busy=!1})},100))}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(c.Q),l.Y36(d.uw),l.Y36(l.R0b))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-auto-reply"]],decls:16,vars:8,consts:[[1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-hidden"],[1,"relative","flex-0","py-2","px-4","md:p-6","xs:p-16","overflow-hidden","bg-primary-800","dark"],["viewBox","0 0 960 540","width","100%","height","100%","preserveAspectRatio","xMidYMax slice","xmlns","http://www.w3.org/2000/svg",1,"absolute","inset-0","pointer-events-none"],["fill","none","stroke","currentColor","stroke-width","100",1,"text-gray-700","opacity-25"],["r","234","cx","196","cy","23"],["r","234","cx","790","cy","491"],[1,"z-10","relative","flex","flex-col","items-center"],[1,"text-xl","font-semibold","text-yellow-400"],[1,"mt-1","text-4xl","sm:text-5xl","font-bold","tracking-tight","leading-tight","text-center"],["cdkScrollable","",1,"flex","flex-col","flex-auto","p-6","sm:p-10","overflow-y-auto"],["class","flex flex-auto flex-col items-center justify-center bg-gray-100 dark:bg-transparent",4,"ngIf"],["class","flex flex-col flex-auto w-full max-w-xs sm:max-w-5xl mx-auto relative",4,"ngIf"],[1,"flex","flex-auto","flex-col","items-center","justify-center","bg-gray-100","dark:bg-transparent"],["svgIcon","heroicons_outline:chat-alt-2",1,"icon-size-20"],[1,"mt-6","text-2xl","font-semibold","tracking-tight","text-secondary","text-center"],[1,"font-normal","text-lg"],["mat-flat-button","","color","primary",1,"md:w-max","xs:w-full","mt-10",3,"disabled","click"],["svgIcon","heroicons_outline:plus",1,"mr-2"],[1,"flex","flex-col","flex-auto","w-full","max-w-xs","sm:max-w-5xl","mx-auto","relative"],[1,"absolute","xs:static","md:-top-5","xs:-top-4","left-auto"],["mat-flat-button","","color","primary",1,"md:w-max","xs:w-full",3,"disabled","click"],["mat-flat-button","","color","secondary",1,"md:ml-2","md:w-max","xs:w-full","xs:mt-5",3,"disabled","click"],["svgIcon","mat_outline:refresh",1,"mr-2"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","gap-8","mt-8","sm:mt-10"],[4,"ngFor","ngForOf"],[1,"flex","flex-col","shadow","rounded-2xl","overflow-hidden","bg-card","relative"],["color","primary",1,"absolute","right-3","top-3",3,"name","ngModel","ngModelChange","toggleChange"],[1,"flex","flex-col","p-6"],[1,"flex","items-center","justify-between"],[1,"py-0.5","px-3","rounded-full","text-sm","font-semibold","text-green-800","bg-green-100","dark:text-green-50","dark:bg-green-500"],["class","text-xs",4,"ngIf"],[4,"ngIf"],[1,"w-12","h-1","my-4","border-t-2"],[1,"line-clamp-2"],["class","flex flex-row flex-wrap",4,"ngIf"],[1,"flex","flex-row","text-sm","italic","text-gray-500","line-clamp-2"],[3,"innerHTML"],[1,"flex","flex-col","w-full","mt-auto"],[1,"p-2","px-1","bg-gray-50","dark:bg-transparent"],["type","button","mat-button","","color","primary",1,"p-0","px-4","text-sm",3,"click"],[1,"inline-flex","items-center"],["svgIcon","heroicons_solid:arrow-sm-right",1,"mr-2","icon-size-6"],[1,"text-xs"],[1,"italic","text-xs"],[1,"flex","flex-row","flex-wrap"],["class","flex mr-2 p-1 px-2 mb-1 text-xs rounded bg-primary text-white",4,"ngFor","ngForOf"],[1,"flex","mr-2","p-1","px-2","mb-1","text-xs","rounded","bg-primary","text-white"],[1,"flex","mr-2","p-1","px-2","mb-1","text-xs","rounded","bg-yellow-400","text-whitex"]],template:function(e,t){1&e&&(l.TgZ(0,"div",0),l.TgZ(1,"div",1),l.O4$(),l.TgZ(2,"svg",2),l.TgZ(3,"g",3),l._UZ(4,"circle",4),l._UZ(5,"circle",5),l.qZA(),l.qZA(),l.kcU(),l.TgZ(6,"div",6),l.TgZ(7,"h2",7),l._uU(8),l.ALo(9,"translate"),l.qZA(),l.TgZ(10,"div",8),l._uU(11),l.ALo(12,"translate"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(13,"div",9),l.YNc(14,Z,13,10,"div",10),l.YNc(15,T,12,6,"div",11),l.qZA(),l.qZA()),2&e&&(l.xp6(8),l.hij(" ",l.lcZ(9,4,"ar.title1")," "),l.xp6(3),l.hij(" ",l.lcZ(12,6,"ar.title2")," "),l.xp6(3),l.Q6J("ngIf",(null==t.List?null:t.List.length)<=0),l.xp6(1),l.Q6J("ngIf",(null==t.List?null:t.List.length)>0))},directives:[f.PQ,m.O5,h.Hw,g.lW,m.sg,p.Rr,u.JJ,u.On],pipes:[x.X$,m.gd],styles:[""]}),e})()},25121:(e,t,i)=>{"use strict";i.r(t),i.d(t,{AutoReplyModule:()=>r});var o=i(38583),s=i(58353),a=i(49616),n=i(37716);i(44875),i(67926);let r=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[[o.ez,s.EB,a.m]]}),e})()},67926:(e,t,i)=>{"use strict";i.d(t,{T:()=>B});var o=i(36461),s=i(23815),a=i.n(s),n=i(37716),r=i(42448),l=i(22238),c=i(3679),d=i(77310),f=i(12522),m=i(38583),h=i(98295),g=i(67441),p=i(51095),u=i(76627),x=i(5015),Z=i(83166),_=i(58341),v=i(7539),b=i(88030),y=i(69129),A=i(29790);function q(e,t){1&e&&(n.TgZ(0,"button",16),n._UZ(1,"mat-icon",17),n.qZA()),2&e&&(n.xp6(1),n.Q6J("svgIcon","heroicons_outline:x"))}function w(e,t){1&e&&(n.ynx(0),n.TgZ(1,"mat-option",18),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.BQk()),2&e&&(n.xp6(2),n.hij(" ",n.lcZ(3,1,"broadcast.form.no_instance")," "))}function T(e,t){if(1&e&&(n.TgZ(0,"mat-option",20),n._uU(1),n.qZA()),2&e){const e=t.$implicit;n.Tol(1!=e.expired&&e.expired_date&&1==e.running?"":"line-through"),n.Q6J("value",e.insid)("disabled",1==e.expired||!e.expired_date||1!=e.running),n.xp6(1),n.hij(" ",null!=e&&null!=e.info&&null!=e.info.me&&e.info.me.user?null==e||null==e.info||null==e.info.me?null:e.info.me.user:e.insid," ")}}function J(e,t){if(1&e&&(n.ynx(0),n.YNc(1,T,2,5,"mat-option",19),n.BQk()),2&e){const e=n.oxw();n.xp6(1),n.Q6J("ngForOf",e.Preq.instance)}}function C(e,t){1&e&&(n.TgZ(0,"mat-icon",32),n._uU(1," cancel "),n.qZA())}function k(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"mat-chip",30),n.NdJ("removed",function(){const t=n.CHM(e).$implicit;return n.oxw(3).remove(t)}),n._uU(1),n.YNc(2,C,2,0,"mat-icon",31),n.qZA()}if(2&e){const e=t.$implicit,i=n.oxw(3);n.Q6J("selectable",!0)("removable",!0),n.xp6(1),n.hij(" ",e," "),n.xp6(1),n.Q6J("ngIf",!i.form.is_detail)}}function L(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"input",33),n.NdJ("matChipInputTokenEnd",function(t){return n.CHM(e),n.oxw(3).add(t)}),n.ALo(1,"translate"),n.ALo(2,"translate"),n.qZA()}if(2&e){n.oxw();const e=n.MAs(5),t=n.oxw(2);n.Q6J("placeholder",(null==t.msg?null:t.msg.length)<=0?n.lcZ(1,4,"ar.form.message.placeholder"):n.lcZ(2,6,"ar.form.message.placeholder2"))("matChipInputFor",e)("matChipInputSeparatorKeyCodes",t.separatorKeysCodes)("matChipInputAddOnBlur",!0)}}function I(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"mat-form-field",6),n.TgZ(1,"mat-label"),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"mat-chip-list",26,27),n.NdJ("ngModelChange",function(t){return n.CHM(e),n.oxw(2).msg=t}),n.ALo(6,"translate"),n.YNc(7,k,3,4,"mat-chip",28),n.YNc(8,L,3,8,"input",29),n.qZA(),n.qZA()}if(2&e){const e=n.oxw(2);n.xp6(2),n.hij(" ",n.lcZ(3,5,"ar.form.message.label")," "),n.xp6(2),n.Q6J("ngModel",e.msg),n.uIk("aria-label",n.lcZ(6,7,"ar.form.message.label")),n.xp6(3),n.Q6J("ngForOf",e.msg),n.xp6(1),n.Q6J("ngIf",!e.form.is_detail)}}function M(e,t){if(1&e){const e=n.EpF();n.ynx(0),n.TgZ(1,"mat-form-field",6),n.TgZ(2,"mat-label"),n._uU(3),n.ALo(4,"translate"),n.qZA(),n.TgZ(5,"mat-select",21),n.NdJ("ngModelChange",function(t){return n.CHM(e),n.oxw().form.operator=t}),n.ALo(6,"translate"),n.TgZ(7,"mat-option",22),n._uU(8),n.ALo(9,"translate"),n.qZA(),n.TgZ(10,"mat-option",22),n._uU(11),n.ALo(12,"translate"),n.qZA(),n.TgZ(13,"mat-option",22),n._uU(14),n.ALo(15,"translate"),n.qZA(),n.qZA(),n.qZA(),n.YNc(16,I,9,9,"mat-form-field",23),n.TgZ(17,"mat-form-field",24),n.TgZ(18,"mat-label"),n._uU(19),n.ALo(20,"translate"),n.qZA(),n.TgZ(21,"textarea",25),n.NdJ("ngModelChange",function(t){return n.CHM(e),n.oxw().form.reply=t}),n.qZA(),n.qZA(),n.BQk()}if(2&e){const e=n.oxw();n.xp6(3),n.hij(" ",n.lcZ(4,14,"ar.form.operator.label")," "),n.xp6(2),n.Q6J("placeholder",n.lcZ(6,16,"ar.form.operator.label"))("ngModel",e.form.operator)("disabled",e.form.is_detail),n.xp6(2),n.Q6J("value",3),n.xp6(1),n.hij(" ",n.lcZ(9,18,"ar.form.operator.v3")," "),n.xp6(2),n.Q6J("value",1),n.xp6(1),n.hij(" ",n.lcZ(12,20,"ar.form.operator.v1")," "),n.xp6(2),n.Q6J("value",2),n.xp6(1),n.hij(" ",n.lcZ(15,22,"ar.form.operator.v2")," "),n.xp6(2),n.Q6J("ngIf",3!=e.form.operator),n.xp6(3),n.hij(" ",n.lcZ(20,24,"ar.form.content.label")," "),n.xp6(2),n.Q6J("ngModel",e.form.reply)("readonly",e.form.is_detail)}}function N(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"section",41),n.TgZ(1,"div",42),n.TgZ(2,"mat-checkbox",43),n.NdJ("ngModelChange",function(t){const i=n.CHM(e).$implicit;return n.oxw(3).sched[i].checked=t})("ngModelChange",function(){const t=n.CHM(e).$implicit;return n.oxw(3).defineSched(t)}),n._uU(3),n.ALo(4,"translate"),n.qZA(),n.qZA(),n.TgZ(5,"mat-form-field",44),n.TgZ(6,"mat-label"),n._uU(7),n.ALo(8,"translate"),n.qZA(),n.TgZ(9,"input",45),n.NdJ("ngModelChange",function(t){const i=n.CHM(e).$implicit;return n.oxw(3).sched[i].start=t}),n.qZA(),n.qZA(),n.TgZ(10,"mat-form-field",44),n.TgZ(11,"mat-label"),n._uU(12),n.ALo(13,"translate"),n.qZA(),n.TgZ(14,"input",46),n.NdJ("ngModelChange",function(t){const i=n.CHM(e).$implicit;return n.oxw(3).sched[i].end=t}),n.qZA(),n.qZA(),n.qZA()}if(2&e){const e=t.$implicit,i=n.oxw(3);n.xp6(2),n.Q6J("name","specific_time_"+e)("ngModel",i.sched[e].checked)("checked",i.sched[e].checked)("disabled",i.form.is_detail),n.xp6(1),n.hij(" ",n.lcZ(4,15,"ar.form.schedule."+e)," "),n.xp6(4),n.hij(" ",n.lcZ(8,17,"ar.form.schedule.from")," "),n.xp6(2),n.Q6J("name","specific_time_from_"+e)("ngModel",i.sched[e].start)("disabled",!i.sched[e].checked||i.form.is_detail)("required",i.sched[e].checked),n.xp6(3),n.hij(" ",n.lcZ(13,19,"ar.form.schedule.to")," "),n.xp6(2),n.Q6J("name","specific_time_to_"+e)("ngModel",i.sched[e].end)("disabled",!i.sched[e].checked||i.form.is_detail)("required",i.sched[e].checked)}}function Q(e,t){if(1&e&&(n.ynx(0),n.YNc(1,N,15,21,"section",40),n.BQk()),2&e){const e=n.oxw(2);n.xp6(1),n.Q6J("ngForOf",e.days)}}function U(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"div",34),n.TgZ(1,"section"),n.TgZ(2,"h4",35),n._uU(3,"Reply To:"),n.qZA(),n.TgZ(4,"p"),n.TgZ(5,"mat-checkbox",36),n.NdJ("ngModelChange",function(t){return n.CHM(e),n.oxw().form.reply_to_r1=t}),n._uU(6," Individual / Contact "),n.qZA(),n.qZA(),n.TgZ(7,"p"),n.TgZ(8,"mat-checkbox",37),n.NdJ("ngModelChange",function(t){return n.CHM(e),n.oxw().form.reply_to_r2=t}),n._uU(9," Group "),n.qZA(),n.qZA(),n.qZA(),n.TgZ(10,"section",38),n.TgZ(11,"h4",35),n._uU(12,"Reply Schedule:"),n.qZA(),n.TgZ(13,"p"),n.TgZ(14,"mat-checkbox",39),n.NdJ("ngModelChange",function(t){return n.CHM(e),n.oxw().form.is_specific_time=t})("ngModelChange",function(){return n.CHM(e),n.oxw().toggleSpecific()}),n._uU(15," Specific Time "),n.qZA(),n.qZA(),n.qZA(),n.YNc(16,Q,2,1,"ng-container",8),n.qZA()}if(2&e){const e=n.oxw();n.xp6(5),n.Q6J("ngModel",e.form.reply_to_r1)("checked",1==e.form.reply_to_r1)("value",1)("disabled",e.form.is_detail),n.xp6(3),n.Q6J("ngModel",e.form.reply_to_r2)("checked",1==e.form.reply_to_r2)("value",1)("disabled",e.form.is_detail),n.xp6(2),n.Q6J("ngClass",e.form.is_specific_time?"pb-4 border-b":""),n.xp6(4),n.Q6J("ngModel",e.form.is_specific_time)("checked",e.form.is_specific_time)("disabled",e.form.is_detail),n.xp6(2),n.Q6J("ngIf",e.form.is_specific_time)}}function S(e,t){if(1&e&&(n.TgZ(0,"button",47),n._UZ(1,"mat-icon",48),n._uU(2),n.ALo(3,"translate"),n.qZA()),2&e){const e=n.oxw();n.Q6J("color","primary")("disabled",!e.form.instance||e.Busy),n.xp6(1),n.Q6J("svgIcon","mat_outline:save"),n.xp6(1),n.hij(" ",n.lcZ(3,4,"ar.form.save")," ")}}function j(e,t){if(1&e){const e=n.EpF();n.ynx(0),n.TgZ(1,"button",49),n._UZ(2,"mat-icon",48),n._uU(3," Delete "),n.qZA(),n.TgZ(4,"button",50),n.NdJ("click",function(){return n.CHM(e),n.oxw().form.is_detail=!1}),n._UZ(5,"mat-icon",48),n._uU(6," Edit "),n.qZA(),n.BQk()}2&e&&(n.xp6(2),n.Q6J("svgIcon","heroicons_outline:trash"),n.xp6(3),n.Q6J("svgIcon","heroicons_outline:pencil"))}let B=(()=>{class e{constructor(e,t){this.core=e,this.dialogRef=t,this.Busy=!1,this.Preq={},this.form={id:"add",reply_to_r1:1},this.msg=[],this.separatorKeysCodes=[o.K5,o.OC],this.days=["1mo","2tu","3we","4th","5fr","6sa","7su"],this.sched=[],this.loaded=!1}ngOnInit(){this.loaded=!0,"add"!=this.form.id&&this.extractData()}extractData(){if(this.form.specific_time&&(this.toggleSpecific(),setTimeout(()=>{let e;try{e=JSON.parse(this.form.specific_time);for(let t of e)this.sched[t.key].checked||(t.start&&(t.start=t.start.replace(/\:/gi,".")),t.end&&(t.end=t.end.replace(/\:/gi,".")),this.sched[t.key]={key:t.key,checked:t.checked,start:t.start,end:t.end})}catch(t){}},500)),this.form.rcv_message_array)this.msg=this.form.rcv_message_array;else if(this.form.rcv_message){let t=[];try{let e=this.form.rcv_message.split(",");for(let i of e)t.push(i)}catch(e){t=[this.form.rcv_message],this.form.rcv_message_array=t}t&&(this.msg=t,this.form.rcv_message_array=t)}}beforeSubmit(e){var t;if(!this.form.instance)return void this.core.OpenAlert({title:this.core.translatePipe("ar.form.alert.instance.header"),msg:this.core.translatePipe("ar.form.alert.instance.msg")});if((null===(t=this.msg)||void 0===t?void 0:t.length)<=0&&3!=this.form.operator)return void this.core.OpenAlert({title:this.core.translatePipe("ar.form.alert.received.header"),msg:this.core.translatePipe("ar.form.alert.received.msg")});if(!this.form.operator)return void this.core.OpenAlert({title:this.core.translatePipe("ar.form.alert.operator.header"),msg:this.core.translatePipe("ar.form.alert.operator.msg")});if(!this.form.reply)return void this.core.OpenAlert({title:this.core.translatePipe("ar.form.alert.reply.header"),msg:this.core.translatePipe("ar.form.alert.reply.msg")});if(!this.form.reply_to_r1&&!this.form.reply_to_r2)return void this.core.OpenAlert({title:this.core.translatePipe("ar.form.alert.reply_to.header"),msg:this.core.translatePipe("ar.form.alert.reply_to.msg")});let i="",o="";for(let s of this.msg)i+=o+s,o=",";if(i&&(this.form.rcv_message=i),this.form.reply_nostrip="[NOSTRIP]"+this.form.reply,this.form.specific_time=null,this.form.is_specific_time&&Object.keys(this.sched).length>0){let e=[];for(let t in this.sched)if(this.sched[t].checked){let i=JSON.parse(JSON.stringify(this.sched[t]));i.start&&(i.start=i.start.replace(/\./gi,":")),i.end&&(i.end=i.end.replace(/\./gi,":")),e.push(i)}this.form.specific_time=JSON.stringify(e)}e()}Submit(){this.beforeSubmit(()=>{let e="add";"add"!=this.form.id&&(e="edit"),this.Busy=!0,this.core.Do(this.Com.url.def+e,this.form).subscribe(e=>{e&&1==e.status&&this.dialogRef.close(e),this.Busy=!1},e=>{this.Busy=!1})})}add(e){const t=(e.value||"").trim();t&&this.msg.push(t),e.chipInput.clear()}remove(e){this.msg=a().filter(this.msg,t=>t.toLowerCase()!=e.toLowerCase())}defineSched(e){this.loaded&&(this.sched[e]=this.sched[e].checked?{key:e,checked:!0,start:"07:00",end:"21:00"}:{})}toggleSpecific(){if(this.form.is_specific_time)for(let e of this.days)this.sched[e]={};else this.sched=[]}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(r.Q),n.Y36(l.so))},e.\u0275cmp=n.Xpm({type:e,selectors:[["dialog-autoreply"]],decls:27,vars:22,consts:[["ngNativeValidate","","cdkDrag","","cdkDragRootElement",".cdk-overlay-pane",1,"flex","flex-col","md:min-w-160","-m-6x",3,"ngSubmit"],["cdkDragHandle","",1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary","m-0"],[1,"text-xl"],["mat-icon-button","","mat-dialog-close","","tabindex","-1",4,"ngIf"],[1,"p-5","px-8","m-0","flex","sm:flex-row","xs:flex-col","flex-auto","pt-5"],[1,"flex","flex-auto","flex-col","min-w-80"],["appearance","outline","floatLabel","auto",1,"smallx"],["name","instance","required","",3,"placeholder","ngModel","disabled","ngModelChange"],[4,"ngIf"],["class","flex flex-auto flex-col sm:ml-4 xs:ml-0",4,"ngIf"],[1,"flex","flex-row","sm:items-start","justify-between","bg-gray-50","p-2","sm:pt-4","pb-1","px-3","m-0"],[1,""],["mat-dialog-close","","type","button","mat-button","",1,"order-first","sm:order-last"],[1,"icon-size-5","mr-1",3,"svgIcon"],[1,"flex","items-end","pr-5"],["class","order-first sm:order-last","mat-flat-button","",3,"color","disabled",4,"ngIf"],["mat-icon-button","","mat-dialog-close","","tabindex","-1"],[1,"text-current",3,"svgIcon"],["disabled",""],[3,"value","disabled","class",4,"ngFor","ngForOf"],[3,"value","disabled"],["name","operator","required","",3,"placeholder","ngModel","disabled","ngModelChange"],[3,"value"],["appearance","outline","floatLabel","auto","class","smallx",4,"ngIf"],["appearance","outline","floatLabel","auto"],["matInput","","required","","rows","10","name","reply",3,"ngModel","readonly","ngModelChange"],["name","message",3,"ngModel","ngModelChange"],["receivedMsg",""],[3,"selectable","removable","removed",4,"ngFor","ngForOf"],[3,"placeholder","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd",4,"ngIf"],[3,"selectable","removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""],[3,"placeholder","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],[1,"flex","flex-auto","flex-col","sm:ml-4","xs:ml-0"],[1,"font-semibold"],["name","reply_1","color","primary",3,"ngModel","checked","value","disabled","ngModelChange"],["name","reply_2","color","primary",3,"ngModel","checked","value","disabled","ngModelChange"],[1,"mt-4","mb-4",3,"ngClass"],["name","is_specific_time","color","primary",3,"ngModel","checked","disabled","ngModelChange"],["class","flex flex-auto flex-row",4,"ngFor","ngForOf"],[1,"flex","flex-auto","flex-row"],[1,"flex","flex-auto","pt-3","min-w-30"],["color","primary",3,"name","ngModel","checked","disabled","ngModelChange"],["appearance","outline","floatLabel","always",1,"small","ml-2","max-w-16"],["matInput","","placeholder","07:00","mask","Hh:m0",1,"text-right",3,"name","ngModel","disabled","required","ngModelChange"],["matInput","","mask","Hh:m0","placeholder","21:00",1,"text-right",3,"name","ngModel","disabled","required","ngModelChange"],["mat-flat-button","",1,"order-first","sm:order-last",3,"color","disabled"],[1,"icon-size-5","mr-2",3,"svgIcon"],["mat-stroked-button","","color","warn",1,"order-first","sm:order-last"],["mat-stroked-button","",1,"order-first","sm:order-last",3,"click"]],template:function(e,t){1&e&&(n.TgZ(0,"form",0),n.NdJ("ngSubmit",function(){return t.Submit()}),n.TgZ(1,"mat-toolbar",1),n.TgZ(2,"div",2),n._uU(3),n.ALo(4,"translate"),n.qZA(),n.YNc(5,q,2,1,"button",3),n.qZA(),n.TgZ(6,"mat-dialog-content",4),n.TgZ(7,"div",5),n.TgZ(8,"mat-form-field",6),n.TgZ(9,"mat-label"),n._uU(10),n.ALo(11,"translate"),n.qZA(),n.TgZ(12,"mat-select",7),n.NdJ("ngModelChange",function(e){return t.form.instance=e}),n.ALo(13,"translate"),n.YNc(14,w,4,3,"ng-container",8),n.YNc(15,J,2,1,"ng-container",8),n.qZA(),n.qZA(),n.YNc(16,M,22,26,"ng-container",8),n.qZA(),n.YNc(17,U,17,13,"div",9),n.qZA(),n.TgZ(18,"mat-dialog-actions",10),n.TgZ(19,"div",11),n.TgZ(20,"button",12),n._UZ(21,"mat-icon",13),n._uU(22),n.ALo(23,"translate"),n.qZA(),n.qZA(),n.TgZ(24,"div",14),n.YNc(25,S,4,6,"button",15),n.YNc(26,j,7,2,"ng-container",8),n.qZA(),n.qZA(),n.qZA()),2&e&&(n.xp6(3),n.hij(" ",n.lcZ(4,14,"ar.form.title")," "),n.xp6(2),n.Q6J("ngIf",!t.Busy),n.xp6(5),n.hij(" ",n.lcZ(11,16,"broadcast.form.select_instance")," "),n.xp6(2),n.Q6J("placeholder",n.lcZ(13,18,"broadcast.form.select_instance"))("ngModel",t.form.instance)("disabled",t.form.is_detail),n.xp6(2),n.Q6J("ngIf",(null==t.Preq||null==t.Preq.instance?null:t.Preq.instance.length)<=0),n.xp6(1),n.Q6J("ngIf",(null==t.Preq||null==t.Preq.instance?null:t.Preq.instance.length)>0),n.xp6(1),n.Q6J("ngIf",t.form.instance),n.xp6(1),n.Q6J("ngIf",t.form.instance),n.xp6(4),n.Q6J("svgIcon","mat_outline:close"),n.xp6(1),n.hij(" ",n.lcZ(23,20,"button.close")," "),n.xp6(3),n.Q6J("ngIf",!t.form.is_detail),n.xp6(1),n.Q6J("ngIf",t.form.is_detail))},directives:[c.JL,c.F,d.Zt,f.Ye,d.Bh,m.O5,l.xY,h.KE,h.hX,g.gD,c.Q7,c.JJ,c.On,l.H8,p.lW,l.ZT,u.Hw,x.ey,m.sg,Z.Nt,c.Fj,_.qn,_.HS,_.qH,_.oH,v.oG,m.mk,b.oO,y.hx],pipes:[A.X$],encapsulation:2}),e})()}}]);