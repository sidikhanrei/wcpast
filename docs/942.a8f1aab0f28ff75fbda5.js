(self.webpackChunkwachatpro_webclient=self.webpackChunkwachatpro_webclient||[]).push([[942],{47908:(t,e,i)=>{"use strict";i.d(e,{i:()=>l});var n=i(37716),s=i(42448),a=i(39895),o=i(37624);let l=(()=>{class t{constructor(t,e){this.core=t,this.router=e,this.SelectedInstance={}}ngOnInit(){const t=this.core.getLS("SelectedInstance");t?(this.SelectedInstance=t,this.core.removeLS("SelectedInstance")):this.router.navigate(["/multiuser"])}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(s.Q),n.Y36(a.F0))},t.\u0275cmp=n.Xpm({type:t,selectors:[["wa-chat-container"]],decls:1,vars:1,consts:[[1,"h-fullx","w-fullx",3,"instance"]],template:function(t,e){1&t&&n._UZ(0,"wa-chat-list",0),2&t&&n.Q6J("instance",e.SelectedInstance)},directives:[o.u],encapsulation:2}),t})()},37624:(t,e,i)=>{"use strict";i.d(e,{u:()=>Q});var n=i(16304),s=i(23815),a=i.n(s),o=i(16738),l=i.n(o),c=i(37716),r=i(42448),d=i(51095),h=i(76627),u=i(71386),g=i(38583),m=i(88030),f=i(70346),p=i(23402);function x(t,e){1&t&&(c.ynx(0),c._UZ(1,"div",38),c.BQk())}function v(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"img",39),c.NdJ("error",function(){return c.CHM(t),c.oxw().$implicit.profilpic=null}),c.qZA()}if(2&t){const t=c.oxw().$implicit;c.Q6J("src",t.profilpic,c.LSH)}}function b(t,e){if(1&t&&c._UZ(0,"div",40),2&t){const t=c.oxw().$implicit;c.Q6J("matBadge",t.unreadCount)}}function w(t,e){if(1&t&&(c.TgZ(0,"span"),c._uU(1),c.qZA()),2&t){const t=c.oxw().$implicit,e=c.oxw(2);c.xp6(1),c.hij(" ",e.showTime(null==t||null==t.last_chat?null:t.last_chat.timestamp)," ")}}function Z(t,e){if(1&t&&(c.TgZ(0,"span"),c._uU(1),c.qZA()),2&t){const t=c.oxw().$implicit,e=c.oxw(2);c.xp6(1),c.hij(" ",e.showTime(null==t?null:t.timestamp)," ")}}function y(t,e){if(1&t&&(c.TgZ(0,"div",41),c._UZ(1,"mat-icon",42),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(1),c.Q6J("ngClass",3===(null==t||null==t.last_chat?null:t.last_chat.ack)?"text-blue-600":"text-gray-400")}}function A(t,e){if(1&t&&c._UZ(0,"span",43),2&t){const t=c.oxw().$implicit,e=c.oxw(2);c.Q6J("innerHTML",e.toHtml(null==t||null==t.last_chat?null:t.last_chat.body),c.oJD)}}function _(t,e){1&t&&c._UZ(0,"mat-icon",48)}function S(t,e){1&t&&c._UZ(0,"mat-icon",49)}function I(t,e){1&t&&c._UZ(0,"mat-icon",50)}function k(t,e){if(1&t&&c._UZ(0,"span",43),2&t){const t=c.oxw(2).$implicit,e=c.oxw(2);c.Q6J("innerHTML",e.toHtml(t.last_chat.body),c.oJD)}}function T(t,e){if(1&t&&(c.TgZ(0,"span"),c._uU(1),c.qZA()),2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.hij(" ","sticker"==t.last_chat.type?"Sticker":"Media"," ")}}function q(t,e){if(1&t&&(c.TgZ(0,"span"),c.TgZ(1,"div",34),c.TgZ(2,"div",44),c.YNc(3,_,1,0,"mat-icon",45),c.YNc(4,S,1,0,"mat-icon",46),c.YNc(5,I,1,0,"mat-icon",47),c.qZA(),c.TgZ(6,"div",36),c.YNc(7,k,1,1,"span",37),c.YNc(8,T,2,1,"span",19),c.qZA(),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(3),c.Q6J("ngIf","image"==t.last_chat.type),c.xp6(1),c.Q6J("ngIf","sticker"==t.last_chat.type),c.xp6(1),c.Q6J("ngIf","document"==t.last_chat.type),c.xp6(2),c.Q6J("ngIf",null==t||null==t.last_chat?null:t.last_chat.body),c.xp6(1),c.Q6J("ngIf",!(null!=t&&null!=t.last_chat&&t.last_chat.body))}}function M(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",25),c.NdJ("click",function(){const e=c.CHM(t).$implicit;return c.oxw(2).Select(e)}),c.TgZ(1,"div",26),c.YNc(2,x,2,0,"ng-container",19),c.TgZ(3,"div",27),c.YNc(4,v,1,1,"img",28),c.qZA(),c.qZA(),c.TgZ(5,"div",29),c.YNc(6,b,1,1,"div",30),c.TgZ(7,"div",31),c.YNc(8,w,2,1,"span",19),c.YNc(9,Z,2,1,"span",19),c.qZA(),c.TgZ(10,"div",32),c._uU(11),c.qZA(),c.TgZ(12,"div",33),c.TgZ(13,"div",34),c.YNc(14,y,2,1,"div",35),c.TgZ(15,"div",36),c.YNc(16,A,1,1,"span",37),c.YNc(17,q,9,5,"span",19),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit,i=c.oxw(2);c.Q6J("ngClass",t.id==i.chat.id?"bg-gray-100":""),c.xp6(2),c.Q6J("ngIf",t.unreadCount>0&&!(null!=t&&null!=t.last_chat&&t.last_chat.fromMe)),c.xp6(2),c.Q6J("ngIf",t.profilpic),c.xp6(2),c.Q6J("ngIf",(null==t?null:t.unreadCount)>0),c.xp6(2),c.Q6J("ngIf",null==t||null==t.last_chat?null:t.last_chat.timestamp),c.xp6(1),c.Q6J("ngIf",!(null!=t&&null!=t.last_chat&&t.last_chat.timestamp)),c.xp6(2),c.hij(" ",i.showName(t)," "),c.xp6(1),c.Q6J("ngClass",t.unreadCount>0&&(null==t||null==t.last_chat||!t.last_chat.fromMe)?"text-primary font-semibold":""),c.xp6(2),c.Q6J("ngIf",null==t||null==t.last_chat?null:t.last_chat.fromMe),c.xp6(2),c.Q6J("ngIf",!(null!=t&&null!=t.last_chat&&t.last_chat.hasMedia)),c.xp6(1),c.Q6J("ngIf",null==t||null==t.last_chat?null:t.last_chat.hasMedia)}}function C(t,e){if(1&t&&(c.ynx(0),c.YNc(1,M,18,11,"div",24),c.BQk()),2&t){const t=c.oxw();c.xp6(1),c.Q6J("ngForOf",t.List)}}function J(t,e){1&t&&(c.TgZ(0,"div",51),c._UZ(1,"mat-icon",52),c.TgZ(2,"div",53),c._uU(3," No chats "),c.qZA(),c.qZA()),2&t&&(c.xp6(1),c.Q6J("svgIcon","iconsmind:speach_bubble"))}function z(t,e){1&t&&(c.TgZ(0,"div",54),c._UZ(1,"mat-icon",52),c.TgZ(2,"div",53),c._uU(3,"Select a conversation or start a new chat"),c.qZA(),c.qZA()),2&t&&(c.xp6(1),c.Q6J("svgIcon","iconsmind:speach_bubble"))}function Y(t,e){if(1&t&&c._UZ(0,"wa-conversation",55),2&t){const t=c.oxw();c.Q6J("instance",t.instance)("chat",t.chat)}}let Q=(()=>{class t{constructor(t){this.core=t,this.AllSub={},this.instance={},this.LastInstance={},this.List=[],this.aktifTimer=6e4,this.Updated=!0,this.NoChat=[],this.domList=100,this.Limit=100,this.Busy=!1,this.chat={}}ngOnInit(){let t=100;if(this.LastInstance.id!=this.instance.id&&(this.LastInstance=this.instance,this.List=[],t=500,Object.keys(this.AllSub).length>0))for(let e in this.AllSub)this.AllSub[e]&&(this.AllSub[e].unsubscribe(),console.log("detroy",e));setTimeout(()=>{this.loadData()},t),window.onbeforeunload=()=>this.ngOnDestroy()}ngOnDestroy(){if(this.core.stopAktif(),Object.keys(this.AllSub).length>0)for(let t in this.AllSub)this.AllSub[t]&&(this.AllSub[t].unsubscribe(),console.log("detroy",t))}initSnapshot(t=!1){var e=this;return(0,n.Z)(function*(){if(!e.AllSub.chats){e.core.watchAktif(e.instance);let t=10;"loadNewList"==e.core.sharingTemp&&(t=100,e.core.sharingTemp=null);const i=yield e.core.FS.collection(e.instance.insid+"-chat-list",e=>e.limit(t).orderBy("timestamp","desc"));e.AllSub.chats=yield i.snapshotChanges().subscribe(i=>{let n=i.map(t=>t.payload.doc.data());n=a().filter(n,t=>t.timestamp),n=a().orderBy(n,["timestamp"],["desc"]),e.updateStorage(n,"chat-list-"+e.instance.insid,i=>{var n,s,a,o;(null===(s=null===(n=i[0])||void 0===n?void 0:n.last_chat)||void 0===s?void 0:s.ack)==(null===(o=null===(a=e.List[0])||void 0===a?void 0:a.last_chat)||void 0===o?void 0:o.ack)&&i[0].timestamp==e.List[0].timestamp||e.loadData(),e.Updated=!0,100==t&&(e.AllSub.chats.unsubscribe(),e.AllSub.chats=null,e.initSnapshot())})})}})()}Select(t){t.id!=this.chat.id&&(this.chat={},setTimeout(()=>{this.chat=t},100))}updateStorage(t,e=this.instance.insid+"-chat-list",i=null){this.core.getStorage({id:e,isjson:!0}).then(n=>{let s=t;if(n){for(let t of s)n=a().filter(n,e=>e.id._serialized!=t.id._serialized&&e.timestamp);s=[...s,...n]}s=a().orderBy(s,["timestamp"],["desc"]),this.core.setStorage({id:e,isjson:!0},s).then(()=>{i&&i(s)})})}loadData(){var t=this;clearTimeout(this.delayLoadData),this.delayLoadData=setTimeout(()=>{var e;this.instance&&(null===(e=this.instance)||void 0===e?void 0:e.insid)&&this.core.getStorage({id:"chat-list-"+this.instance.insid,isjson:!0}).then(function(){var e=(0,n.Z)(function*(e){if(e){var i=e.slice(0,t.Limit);t.List=i,t.extractNoChat()}});return function(t){return e.apply(this,arguments)}}())},10)}extractNoChat(){var t=this;this.busyNoChat&&!this.AllSub.snapshotCmdExract||this.core.getStorage({id:"chat-list-"+this.instance.insid,isjson:!0}).then(function(){var e=(0,n.Z)(function*(e){let i=a().filter(e,t=>!t.last_chat),s=[],o=0;for(let t of i){if(o>=10)break;s.push(t.id._serialized),o++}if(s.length<=0)return void t.initSnapshot();let l={phone:t.instance.insid,cmd:"getdetail",user:s,time:null},c=yield t.core.FS.collection(t.instance.insid+"-command",t=>t.limit(1)).doc(t.instance.insid);yield c.set(l),t.AllSub.snapshotCmdExtract=yield t.core.FS.collection(t.instance.insid+"-command",t=>t.limit(1)).doc(t.instance.insid).snapshotChanges().subscribe(function(){var e=(0,n.Z)(function*(e){e.payload.data().time&&(t.AllSub.snapshotCmdExtract.unsubscribe(),yield t.core.FS.collection(t.instance.insid+"-chat-list",t=>t.where("id._serialized","in",s).limit(s.length)).get().subscribe(e=>{let i=e.docs.map(t=>t.data());i.length>0&&t.updateStorage(i,"chat-list-"+t.instance.insid,()=>{t.loadData()})}))});return function(t){return e.apply(this,arguments)}}())});return function(t){return e.apply(this,arguments)}}())}showName(t){return t.name?t.name:t.pushname?t.pushname:t.number}showTime(t){let e,i=l()(l().unix(t)).format("YYYYMMDD"),n=l()(l()(new Date)).format("YYYYMMDD"),s=l()(l()(new Date)).subtract(1,"days").format("YYYYMMDD");return e=i!=n?i==s?this.core.translatePipe("yesterday"):l().unix(t).format("M/D/YY"):l().unix(t).format("HH:mm"),e}toHtml(t){if(t)return t=t.replace(/(?:\\[rn])+/g," "),this.core.text2html(t)}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(r.Q))},t.\u0275cmp=c.Xpm({type:t,selectors:[["wa-chat-list"]],inputs:{instance:"instance"},decls:29,vars:11,consts:[[1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-hidden"],[1,"flex-auto","h-full"],[1,"flex","flex-col","overflow-hidden","h-full"],[1,"flex","flex-auto","overflow-hidden","border","h-full"],[1,"flex","flex-row","flex-auto"],[1,"relative","flex","bg-card","dark:bg-transparent","border-r"],[1,"flex","overflow-hidden"],[1,"relative","flex","flex-auto","flex-col","w-full","min-w-0","lg:min-w-100","lg:max-w-100","bg-card","dark:bg-transparent"],[1,"flex","flex-col","flex-0","py-4","px-8","border-b","bg-gray-700","dark:bg-transparent"],[1,"flex","items-center"],[1,"flex","items-center","mr-1","cursor-pointer","pl-7x"],[1,"w-12","h-12"],[1,"flex","items-center","justify-center","w-full","h-full","rounded-full","text-xl","uppercase","bg-gray-200","text-gray-600","dark:bg-gray-700","dark:text-gray-200"],[1,"ml-4","font-medium","truncate","text-gray-50"],[1,"text-sm"],["mat-icon-button","",1,"ml-auto"],[1,"icon-size-8","text-gray-50",3,"svgIcon"],["customVirtualScrollStrategy","","minBufferPx","1000","maxBufferPx","1500",1,"virtual-container","overflow-x-hidden",3,"itemSize"],[1,"flex-auto","overflow-y-auto"],[4,"ngIf"],["class","flex flex-auto flex-col items-center justify-center h-full pt-10",4,"ngIf"],[1,"flex","flex-auto"],["class","flex flex-col flex-auto items-center justify-center bg-gray-100 dark:bg-transparent",4,"ngIf"],["class","w-full",3,"instance","chat",4,"ngIf"],["class","z-20 flex flex-auto items-center py-5 px-8 cursor-pointer border-b lg:min-w-100 lg:max-w-100 hover:bg-gray-50 dark:hover:bg-hover",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"z-20","flex","flex-auto","items-center","py-5","px-8","cursor-pointer","border-b","lg:min-w-100","lg:max-w-100","hover:bg-gray-50","dark:hover:bg-hover",3,"ngClass","click"],[1,"relative","flex","flex-0","items-center","justify-center","w-10","h-10"],[2,"background-image","url('/assets/icons/noprofil.svg')","background-repeat","no-repeat","background-size","cover","background-position","center","min-width","48px","min-height","48px"],["class","w-full h-full rounded-full",3,"src","error",4,"ngIf"],[1,"min-w-0","ml-4","relative","lg:min-w-64","lg:max-w-64"],["madBadgeSize","small","class","absolute right-0 bottom-3",3,"matBadge",4,"ngIf"],[1,"text-sm","leading-5","text-secondary","absolute","-right-3","top-0"],[1,"font-medium","leading-5","truncate","relative","w-full"],[1,"leading-5","truncate","text-secondary","text-sm","mt-1","line-clamp-1","max-w-60",3,"ngClass"],[1,"flex","flex-row"],["class","flex mr-1",4,"ngIf"],[1,"flex","flex-auto","line-clamp-1"],[3,"innerHTML",4,"ngIf"],[1,"absolute","bottom-0","right-0","flex-0","w-2","h-2","-ml-0.5","rounded-full","ring-2","dark:ring-gray-900","bg-primary","dark:bg-primary-500","text-on-primary","ring-primary-50"],[1,"w-full","h-full","rounded-full",3,"src","error"],["madBadgeSize","small",1,"absolute","right-0","bottom-3",3,"matBadge"],[1,"flex","mr-1"],["svgIcon","doublecheck",1,"icon-size-4",3,"ngClass"],[3,"innerHTML"],[1,"flex"],["class","icon-size-4 mr-1 text-gray-600","style","margin-top: 1px;","svgIcon","camera_alt",4,"ngIf"],["class","icon-size-5 mr-1 text-gray-600","style","margin-top: 1px;","svgIcon","emoji_emotions",4,"ngIf"],["class","icon-size-4 mr-1 text-gray-600","style","margin-top: 0px;","svgIcon","insert_drive_file",4,"ngIf"],["svgIcon","camera_alt",1,"icon-size-4","mr-1","text-gray-600",2,"margin-top","1px"],["svgIcon","emoji_emotions",1,"icon-size-5","mr-1","text-gray-600",2,"margin-top","1px"],["svgIcon","insert_drive_file",1,"icon-size-4","mr-1","text-gray-600",2,"margin-top","0px"],[1,"flex","flex-auto","flex-col","items-center","justify-center","h-full","pt-10"],[1,"icon-size-24",3,"svgIcon"],[1,"mt-4","text-2xl","font-semibold","tracking-tight","text-secondary"],[1,"flex","flex-col","flex-auto","items-center","justify-center","bg-gray-100","dark:bg-transparent"],[1,"w-full",3,"instance","chat"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"div",3),c.TgZ(4,"div",4),c.TgZ(5,"div",5),c.TgZ(6,"div",6),c.TgZ(7,"div",7),c.TgZ(8,"div",8),c.TgZ(9,"div",9),c.TgZ(10,"div",10),c.TgZ(11,"div",11),c.TgZ(12,"div",12),c._uU(13),c.ALo(14,"uppercase"),c.qZA(),c.qZA(),c.TgZ(15,"div",13),c.TgZ(16,"div"),c._uU(17),c.qZA(),c.TgZ(18,"div",14),c._uU(19),c.qZA(),c.qZA(),c.qZA(),c.TgZ(20,"button",15),c._UZ(21,"mat-icon",16),c.qZA(),c.qZA(),c.qZA(),c.TgZ(22,"cdk-virtual-scroll-viewport",17),c.TgZ(23,"div",18),c.YNc(24,C,2,1,"ng-container",19),c.YNc(25,J,4,1,"div",20),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(26,"div",21),c.YNc(27,z,4,1,"div",22),c.YNc(28,Y,1,2,"wa-conversation",23),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&t&&(c.xp6(13),c.hij(" ",c.lcZ(14,9,null==e.instance||null==e.instance.info?null:e.instance.info.pushname.charAt(0))," "),c.xp6(4),c.hij(" ",null==e.instance||null==e.instance.info?null:e.instance.info.pushname," "),c.xp6(2),c.hij(" ",null==e.instance||null==e.instance.info||null==e.instance.info.me?null:e.instance.info.me.user," "),c.xp6(2),c.Q6J("svgIcon","heroicons_outline:plus-circle"),c.xp6(1),c.Q6J("itemSize",0),c.xp6(2),c.Q6J("ngIf",(null==e.List?null:e.List.length)>0),c.xp6(1),c.Q6J("ngIf",(null==e.List?null:e.List.length)<=0),c.xp6(2),c.Q6J("ngIf",!e.chat||!e.chat.id),c.xp6(1),c.Q6J("ngIf",e.chat&&e.chat.id))},directives:[d.lW,h.Hw,u.N7,u.xd,g.O5,g.sg,g.mk,m.oO,f.k,p.s],pipes:[g.gd],encapsulation:2}),t})()},23402:(t,e,i)=>{"use strict";i.d(e,{s:()=>N});var n=i(16304),s=i(23815),a=i.n(s),o=i(16738),l=i.n(o),c=i(37716),r=i(42448),d=i(38583),h=i(51095),u=i(76627),g=i(98295),m=i(83166),f=i(3679),p=i(88030),x=i(29790);function v(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"img",25),c.NdJ("error",function(){return c.CHM(t),c.oxw().chat.profilpic=null}),c.qZA()}if(2&t){const t=c.oxw();c.Q6J("src",null==t.chat?null:t.chat.profilpic,c.LSH)}}function b(t,e){1&t&&c.GkF(0)}const w=function(t,e){return{"text-gray-200 -right-1 -mr-px mb-px":t,"text-white -left-1 -ml-px mb-px -scale-x-1":e}};function Z(t,e){if(1&t&&(c.ynx(0),c.TgZ(1,"div",33),c.YNc(2,b,1,0,"ng-container",34),c.qZA(),c.BQk()),2&t){const t=c.oxw().$implicit;c.oxw();const e=c.MAs(30);c.xp6(1),c.Q6J("ngClass",c.WLB(2,w,t.fromMe,!t.fromMe)),c.xp6(1),c.Q6J("ngTemplateOutlet",e)}}function y(t,e){if(1&t&&c._UZ(0,"div",35),2&t){const t=c.oxw().$implicit,e=c.oxw();c.Q6J("innerHTML",e.toHtml(t.body),c.oJD)}}function A(t,e){if(1&t&&c._UZ(0,"div",38),2&t){const t=c.oxw(2).$implicit,e=c.oxw();c.Udp("margin-top",e.ChatImg[t.id._serialized].sHeight+10+"px!important"),c.Q6J("innerHTML",e.toHtml(t.body),c.oJD)}}function _(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",36),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw().openImage(e)}),c.YNc(1,A,1,3,"div",37),c.qZA()}if(2&t){const t=c.oxw().$implicit,e=c.oxw();c.Udp("background-image","url("+e.ChatImg[t.id._serialized].src+")")("width",e.ChatImg[t.id._serialized].sWidth+"px!important")("height",e.ChatImg[t.id._serialized].sHeight+"px!important"),c.xp6(1),c.Q6J("ngIf",t.body)}}function S(t,e){if(1&t&&c._UZ(0,"div",38),2&t){const t=c.oxw(2).$implicit,e=c.oxw();c.Q6J("innerHTML",e.toHtml(t.body),c.oJD)}}function I(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",39),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit;return c.oxw().openImage(e)}),c.YNc(1,S,1,1,"div",40),c.qZA()}if(2&t){const t=c.oxw().$implicit;c.xp6(1),c.Q6J("ngIf",t.body)}}function k(t,e){1&t&&c._UZ(0,"mat-icon",42)}function T(t,e){if(1&t&&c._UZ(0,"mat-icon",45),2&t){const t=c.oxw(3).$implicit;c.Q6J("ngClass",3===(null==t?null:t.ack)?"text-blue-600":"text-gray-400")}}function q(t,e){1&t&&c._UZ(0,"mat-icon",46)}function M(t,e){if(1&t&&(c.ynx(0),c.YNc(1,T,1,1,"mat-icon",43),c.YNc(2,q,1,0,"mat-icon",44),c.BQk()),2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.Q6J("ngIf",3==t.ack||2==t.ack),c.xp6(1),c.Q6J("ngIf",1==t.ack||0==t.ack)}}function C(t,e){if(1&t&&(c.ynx(0),c.YNc(1,k,1,0,"mat-icon",41),c.YNc(2,M,3,2,"ng-container",28),c.BQk()),2&t){const t=c.oxw().$implicit;c.xp6(1),c.Q6J("ngIf",t.sending),c.xp6(1),c.Q6J("ngIf",!t.sending)}}const J=function(t,e,i,n){return{"items-end":t,"items-start":e,"mt-0.5":i,"mt-3":n}},z=function(t,e,i){return{"bg-gray-200 shadow":t,"bg-white shadow":e,"bg-transparent":i}},Y=function(t,e){return{"ml-3":t,"ml-3":e}};function Q(t,e){if(1&t&&(c.ynx(0),c.TgZ(1,"div",26),c.TgZ(2,"div",27),c.YNc(3,Z,3,5,"ng-container",28),c.YNc(4,y,1,1,"div",29),c.YNc(5,_,2,7,"div",30),c.YNc(6,I,2,1,"div",31),c.ynx(7),c.TgZ(8,"div",32),c._uU(9),c.YNc(10,C,3,2,"ng-container",28),c.qZA(),c.BQk(),c.qZA(),c.qZA(),c.BQk()),2&t){const t=e.$implicit,i=e.index,n=c.oxw();c.xp6(1),c.Q6J("ngClass",c.l5B(12,J,t.fromMe,!t.fromMe,i>0&&n.List[i-1]&&n.List[i-1].fromMe===t.fromMe,i>0&&n.List[i-1]&&n.List[i-1].fromMe!==t.fromMe)),c.xp6(1),c.Gre("relative max-w-3/4 px-3 py-2 rounded-xl msg-container-",i,""),c.Q6J("ngClass",c.kEZ(17,z,t.fromMe&&"sticker"!=t.type,!t.fromMe&&"sticker"!=t.type,"sticker"==t.type)),c.xp6(1),c.Q6J("ngIf",n.List[i+1]&&n.List[i+1].fromMe!==t.fromMe&&"sticker"!=t.type),c.xp6(1),c.Q6J("ngIf",t.body&&!t.hasMedia),c.xp6(1),c.Q6J("ngIf",t.hasMedia&&"document"!=t.type&&n.ChatImg[t.id._serialized]),c.xp6(1),c.Q6J("ngIf",t.hasMedia&&"document"==t.type),c.xp6(2),c.Q6J("ngClass",c.WLB(21,Y,t.fromMe,!t.fromMe)),c.xp6(1),c.hij(" ",n.formatDate(t.timestamp)," "),c.xp6(1),c.Q6J("ngIf",t.fromMe)}}function L(t,e){1&t&&(c.O4$(),c.TgZ(0,"svg",47),c.TgZ(1,"g",48),c._UZ(2,"path",49),c.qZA(),c.qZA())}let N=(()=>{class t{constructor(t){this.core=t,this.AllSub={},this.Busy=!0,this.maxImg={w:300,h:450},this.minImg={w:200,h:300},this.List=[],this.ChatImg=[]}ngOnInit(){this.chat&&Object.keys(this.chat).length>0&&(this.Name="chat-"+this.instance.id+"-"+this.chat.id._serialized),setTimeout(()=>{this.loadData(),this.getDetailChat(),setTimeout(()=>{this.getDetail()},100)},100),window.onbeforeunload=()=>this.ngOnDestroy()}ngOnDestroy(){if(Object.keys(this.AllSub).length>0)for(let t in this.AllSub)this.AllSub[t]&&this.AllSub[t].unsubscribe()}loadData(){var t;(null===(t=this.instance)||void 0===t?void 0:t.insid)&&this.core.getStorage({id:this.Name,isjson:!0}).then(t=>{if(t){if(this.core.isJSON(t)){let e=JSON.parse(JSON.stringify(t));this.List=e;for(let t of this.List)this.imgOrientation(t)}else this.List=[];this.clientscript(),this.Busy=!1,setTimeout(()=>{$(".conversation-container").animate({scrollTop:$(".conversation-container").height()+1e4},10);var t=this.List[this.List.length-1];this.LastMessage==t.timestamp||t.fromMe||(this.LastMessage=t.timestamp)},100)}else this.Busy=!1;this.AllSub["chat-"+this.chat.id._serialized]||this.initWatch()})}clientscript(){$(".chat-container").animate({scrollTop:$(".chat-container").height()+1e5},10),setTimeout(()=>{$("#message").focus()},500)}initWatch(){var t=this;this.AllSub["chat-"+this.chat.id._serialized]||(this.AllSub["chat-"+this.chat.id._serialized]=this.core.FS.collection(this.instance.insid+"-chats",t=>t.where("id._serialized","==",this.chat.id._serialized)).doc(this.chat.id._serialized).snapshotChanges().subscribe(function(){var e=(0,n.Z)(function*(e){const i=e.payload.data();if(i){if(t.core.isJSON(i.chats)){t.List=i.chats,t.setChat(t.List);for(let e of t.List)t.imgOrientation(e);t.clientscript()}else t.List=[];t.Busy=!1,setTimeout(()=>{$(".conversation-container").animate({scrollTop:$(".conversation-container").height()+1e4},10)},100)}});return function(t){return e.apply(this,arguments)}}()))}getDetail(){var t=this;return(0,n.Z)(function*(){let e={phone:t.instance.insid,cmd:"getdetail",user:[t.chat.id._serialized],time:null},i=yield t.core.FS.collection(t.instance.insid+"-command",t=>t.limit(1)).doc(t.instance.insid);yield i.set(e)})()}getDetailChat(){var t=this;return(0,n.Z)(function*(){t.AllSub["chat-detail-"+t.chat.id._serialized]||(t.AllSub["chat-detail-"+t.chat.id._serialized]=yield t.core.FS.collection(t.instance.insid+"-chats",t=>t.limit(1)).doc(t.chat.id._serialized).snapshotChanges().subscribe(function(){var e=(0,n.Z)(function*(e){const i=e.payload.data();i&&t.core.getStorage({id:"chat-list-"+t.instance.insid,isjson:!0}).then(e=>{if(e){let n=e;n=a().filter(n,t=>t.id._serialized!=i.id._serialized);let s=JSON.parse(JSON.stringify(i));s.last_chat=s.chats[s.chats.length-1],s.chats&&delete s.chats,n.push(s),n=a().orderBy(n,["timestamp"],["desc"]),t.core.setStorage({id:"chat-list-"+t.instance.insid,isjson:!0},n)}}).catch(t=>{console.log("Error Get Detail",t)}),t.AllSub["chat-detail-"+t.chat.id._serialized].unsubscribe()});return function(t){return e.apply(this,arguments)}}()))})()}sendMessage(){var t=this;return(0,n.Z)(function*(){if(!t.message||!t.chat.id._serialized)return;let e=t.chat.id._serialized;var i=t.message;t.List.push({fromMe:!0,timestamp:l()(new Date).unix(),body:t.toHtml(i),sending:!0}),t.message=null,setTimeout(()=>{t.clientscript()},100);var n={phone:e,cmd:"sendmessage",message:i,time:null};let s=yield t.core.FS.collection(t.instance.insid+"-command",t=>t.limit(1)).doc(e);yield s.set(n),t.List[t.List.length-1].sending=!1,setTimeout(()=>{t.List[t.List.length-1].ack=1},100)})()}checkEnter(t){t.shiftKey&&"Enter"===t.key||"Enter"===t.key&&(t.preventDefault(),this.sendMessage())}setChat(t,e=null){this.core.setStorage({id:this.Name,isjson:!0},t).then(()=>{e&&e()})}showName(t){return t.name?t.name:t.pushname?t.pushname:t.number}showTime(t){let e,i=l()(l().unix(t)).format("YYYYMMDD"),n=l()(l()(new Date)).format("YYYYMMDD"),s=l()(l()(new Date)).subtract(1,"days").format("YYYYMMDD");return e=i!=n?i==s?this.core.translatePipe("yesterday"):l().unix(t).format("M/D/YY"):l().unix(t).format("HH:mm"),e}toHtml(t){if(t)return t=t.replace(/(?:\\[rn])+/g," "),this.core.text2html(t)}showImage(t){}formatDate(t){let e;return e=l()(l().unix(t)).format("YYYYMMDD")!=l()(l()(new Date)).format("YYYYMMDD")?l().unix(t).format("YYYY-MM-DD HH:mm"):l().unix(t).format("HH:mm"),e}openImage(t){"sticker"!=t.type&&(this.core.ShowLoader(),this.core.FBIMG(t.id._serialized,e=>{var i;if(e){if("document"==t.type){var n=document.createElement("a");n.download="Download Media",n.href=e,n.click()}else window.open(e,"_blank");this.core.HideLoader()}else{let e=this.instance.insid+"/"+t.filename;if(!t.filename){let n;try{n=(null===(i=null==t?void 0:t.mediaBase)||void 0===i?void 0:i.filename)?`${t.mediaBase.filename.split(".")[1]}`:t.mediaBase.mimetype.includes("audio/ogg; codecs=opus")?"mp3":`${t.mediaBase.mimetype.split("/")[1]}`}catch(s){this.core.OpenNotif("Please try again!")}if(!n)return void this.core.HideLoader();e=this.instance.insid+"/"+t.id._serialized+"."+n}e&&this.core.FStorage.ref(e).getDownloadURL().subscribe(e=>{this.core.FBIMG(t.id._serialized,()=>{if("document"==t.type){var i=document.createElement("a");i.download="Download Media",i.href=e,i.click()}else window.open(e,"_blank");this.core.HideLoader()},e)})}}))}imgOrientation(t){var e;if(t.mediaBase&&t.mediaBase.data&&t.mediaBase.mimetype.indexOf("image")>-1){this.ChatImg[t.id._serialized]||(this.ChatImg[t.id._serialized]={});let n=this.ChatImg[t.id._serialized],s="data:"+t.mediaBase.mimetype+";base64,"+(null===(e=null==t?void 0:t.mediaBase)||void 0===e?void 0:e.data);if(!s)return;var i=new Image;i.onload=()=>{n.src=s,n.width=i.width,n.height=i.height,n.sWidth=i.width,n.sHeight=i.height,i.width>i.height?n.orientation="hor":i.width==i.height?(n.orientation="square",n.small=!0):n.orientation="ver",n.width<this.minImg.w&&n.height<this.minImg.h&&(n.sWidth=this.minImg.w,n.sHeight=this.minImg.h),n.width<this.minImg.w&&(n.sWidth=this.minImg.w,n.height<this.minImg.h&&(n.sHeight=this.minImg.h)),n.width>this.maxImg.w&&(n.sWidth=this.maxImg.w),n.height>this.maxImg.h&&(n.sHeight=this.maxImg.h)},i.src=s}}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(r.Q))},t.\u0275cmp=c.Xpm({type:t,selectors:[["wa-conversation"]],inputs:{chat:"chat",instance:"instance"},decls:31,vars:12,consts:[[1,"flex","flex-col","flex-auto","overflow-y-auto","lg:overflow-hidden","bg-card","dark:bg-default","h-full"],[1,"flex-auto","h-full"],[1,"flex","flex-col","flex-auto","overflow-hidden","h-full"],[1,"flex","flex-0","items-center","h-18","px-4","md:px-6","border-b","bg-gray-50","dark:bg-transparent","border-lx","shadow-lg"],[1,"flex","items-center","ml-2","lg:ml-0","mr-2","cursor-pointer"],[1,"relative","flex","flex-0","items-center","justify-center","w-10","h-10"],[2,"background-image","url('/assets/icons/noprofil.svg')","background-repeat","no-repeat","background-size","cover","background-position","center","min-width","48px","min-height","48px"],["class","w-full h-full rounded-full",3,"src","error",4,"ngIf"],[1,"ml-4","text-lg","font-medium","leading-5","truncate"],[1,"text-sm","font-normal","text-gray-400","mt-0.5",2,"padding-left","1px"],[1,"flex","overflow-y-auto","flex-col-reverse","h-full"],[1,"chat-container","flex","flex-col","overflow-y-auto","flex-shrink","p-6","bg-card","dark:bg-transparent","h-full"],[4,"ngFor","ngForOf"],[1,"flex","items-end","p-4","border-t","bg-gray-50","dark:bg-transparent"],[1,"flex","items-center","h-11","my-px"],["mat-icon-button",""],[3,"svgIcon"],["mat-icon-button","",1,"ml-0.5"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","fuse-mat-boldx","w-full","ml-4"],["matInput","","matTextareaAutosize","","id","message",1,"min-h-5","my-0","resize-nonex",2,"margin","11px 0 !important","padding","0 !important",3,"ngModel","matAutosizeMaxRows","placeholder","ngModelChange","keydown"],["messageInput",""],[1,"flex","items-center","h-11","my-px","ml-4"],["mat-icon-button","","type","button",3,"click"],[1,"transform","rotate-90",3,"svgIcon"],["speechBubbleExtension",""],[1,"w-full","h-full","rounded-full",3,"src","error"],[1,"flex","flex-col",3,"ngClass"],[2,"word-break","break-all",3,"ngClass"],[4,"ngIf"],["class","min-w-7 leading-5 chat-item",3,"innerHTML",4,"ngIf"],["class","cursor-pointer img-chat",3,"background-image","width","height","click",4,"ngIf"],["class","cursor-pointer p-5 py-2 font-bold border-2 rounded-2xl bg-gray-100 hover:bg-green-50 hover:border-green-200",3,"click",4,"ngIf"],[1,"mt-1","text-sm","text-gray-400","text-right",3,"ngClass"],[1,"absolute","bottom-0","w-3","transform",3,"ngClass"],[4,"ngTemplateOutlet"],[1,"min-w-7","leading-5","chat-item",3,"innerHTML"],[1,"cursor-pointer","img-chat",3,"click"],["class","min-w-4 leading-5",3,"margin-top","innerHTML",4,"ngIf"],[1,"min-w-4","leading-5",3,"innerHTML"],[1,"cursor-pointer","p-5","py-2","font-bold","border-2","rounded-2xl","bg-gray-100","hover:bg-green-50","hover:border-green-200",3,"click"],["class","min-w-4 leading-5",3,"innerHTML",4,"ngIf"],["class","icon-size-4 ml-1 text-gray-400","style","float: right;","svgIcon","access_time",4,"ngIf"],["svgIcon","access_time",1,"icon-size-4","ml-1","text-gray-400",2,"float","right"],["class","icon-size-4 ml-1","style","float: right;","svgIcon","doublecheck",3,"ngClass",4,"ngIf"],["class","icon-size-4 ml-1 text-gray-400","style","float: right;","svgIcon","check",4,"ngIf"],["svgIcon","doublecheck",1,"icon-size-4","ml-1",2,"float","right",3,"ngClass"],["svgIcon","check",1,"icon-size-4","ml-1","text-gray-400",2,"float","right"],["width","100%","height","100%","viewBox","0 0 66 66","xmlns","http://www.w3.org/2000/svg"],["id","Page-1","stroke","none","stroke-width","1","fill","none","fill-rule","evenodd"],["d","M1.01522827,0.516204834 C-8.83532715,54.3062744 61.7609863,70.5215302 64.8009949,64.3061218 C68.8074951,54.8859711 30.1663208,52.9997559 37.5036011,0.516204834 L1.01522827,0.516204834 Z","fill","currentColor","fill-rule","nonzero"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"div",3),c.TgZ(4,"div",4),c.TgZ(5,"div",5),c.TgZ(6,"div",6),c.YNc(7,v,1,1,"img",7),c.qZA(),c.qZA(),c.TgZ(8,"div",8),c.TgZ(9,"div"),c._uU(10),c.qZA(),c.TgZ(11,"div",9),c._uU(12),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(13,"div",10),c.TgZ(14,"div",11),c.YNc(15,Q,11,24,"ng-container",12),c.qZA(),c.qZA(),c.TgZ(16,"div",13),c.TgZ(17,"div",14),c.TgZ(18,"button",15),c._UZ(19,"mat-icon",16),c.qZA(),c.TgZ(20,"button",17),c._UZ(21,"mat-icon",16),c.qZA(),c.qZA(),c.TgZ(22,"mat-form-field",18),c.TgZ(23,"textarea",19,20),c.NdJ("ngModelChange",function(t){return e.message=t})("keydown",function(t){return e.checkEnter(t)}),c.ALo(25,"translate"),c.qZA(),c.qZA(),c.TgZ(26,"div",21),c.TgZ(27,"button",22),c.NdJ("click",function(){return e.sendMessage()}),c._UZ(28,"mat-icon",23),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.YNc(29,L,3,0,"ng-template",null,24,c.W1O)),2&t&&(c.xp6(7),c.Q6J("ngIf",null==e.chat?null:e.chat.profilpic),c.xp6(3),c.hij(" ",e.showName(e.chat)," "),c.xp6(2),c.hij(" +",null==e.chat||null==e.chat.id?null:e.chat.id.user," "),c.xp6(3),c.Q6J("ngForOf",e.List),c.xp6(4),c.Q6J("svgIcon","heroicons_outline:emoji-happy"),c.xp6(2),c.Q6J("svgIcon","heroicons_outline:paper-clip"),c.xp6(2),c.Q6J("ngModel",e.message)("matAutosizeMaxRows",6)("placeholder",c.lcZ(25,10,"wmu.type")),c.xp6(5),c.Q6J("svgIcon","heroicons_outline:paper-airplane"))},directives:[d.O5,d.sg,h.lW,u.Hw,g.KE,m.Nt,m.D7,f.Fj,f.JJ,f.On,d.mk,p.oO,d.tP],pipes:[x.X$],styles:["wa-conversation .chat-container{background:#efe7dd url(/assets/4e765036-1639-11e6-9201-67e728e86f39.jpg) repeat}wa-conversation .bg-green-wa{background-color:#dcf8c6}wa-conversation .text-green-wa{color:#dcf8c6}wa-conversation .chat-item{min-width:75px!important}wa-conversation .img-chat{display:inline-block;margin:0 -5px;background-size:cover;background-position:50%;background-repeat:no-repeat;width:200px;height:250px;max-width:300px;max-height:375px}wa-conversation .img-horizontal{width:350px!important;height:200px!important}wa-conversation .img-vertical{width:200px!important;height:300px!important}"],encapsulation:2}),t})()},42795:(t,e,i)=>{"use strict";i.d(e,{l:()=>w});var n=i(16304),s=i(23815),a=i.n(s),o=i(16738),l=i.n(o),c=i(37716),r=i(42448),d=i(39895),h=i(51095),u=i(76627),g=i(38583),m=i(88030),f=i(29790);function p(t,e){if(1&t&&(c.ynx(0),c.TgZ(1,"div",15),c._uU(2),c.qZA(),c.TgZ(3,"div"),c._uU(4),c.qZA(),c.BQk()),2&t){const t=c.oxw().$implicit;c.xp6(2),c.hij(" ",null==t.info?null:t.info.pushname," "),c.xp6(2),c.hij(" ",null==t.info||null==t.info.me?null:t.info.me.user," ")}}function x(t,e){1&t&&(c.ynx(0),c.TgZ(1,"div",16),c._UZ(2,"mat-icon",17),c.TgZ(3,"div"),c._uU(4),c.ALo(5,"translate"),c.qZA(),c.qZA(),c.BQk()),2&t&&(c.xp6(4),c.hij(" ",c.lcZ(5,1,"wmu.info.notrun")," "))}function v(t,e){if(1&t){const t=c.EpF();c.ynx(0),c.TgZ(1,"a",10),c.NdJ("click",function(){const e=c.CHM(t).$implicit,i=c.oxw(2);return i.Selected.id!=e.id?i.openInstance(e):null}),c.TgZ(2,"div",11),c.TgZ(3,"div",12),c._uU(4),c.qZA(),c.YNc(5,p,5,2,"ng-container",8),c.YNc(6,x,6,3,"ng-container",8),c.qZA(),c.TgZ(7,"div",13),c._UZ(8,"mat-icon",14),c.qZA(),c.qZA(),c.BQk()}if(2&t){const t=e.$implicit,i=c.oxw(2);c.xp6(1),c.Q6J("ngClass",t.id==i.Selected.id?"bg-hover":""),c.xp6(3),c.hij(" ",t.alias?t.alias:t.insid," "),c.xp6(1),c.Q6J("ngIf",null==t.info?null:t.info.me),c.xp6(1),c.Q6J("ngIf",1!=t.running),c.xp6(2),c.Q6J("ngClass",1==t.running?t.id==i.Selected.id?"text-blue-600":"text-green-500":"text-gray-400")("svgIcon",t.id==i.Selected.id?"mat_outline:check_circle_outline":"wa")}}function b(t,e){if(1&t&&(c.ynx(0),c.YNc(1,v,9,6,"ng-container",9),c.BQk()),2&t){const t=c.oxw();c.xp6(1),c.Q6J("ngForOf",t.Preq.instance)}}let w=(()=>{class t{constructor(t,e){this.core=t,this.router=e,this.AllSub={},this.Ready=!1,this.Any={},this.Busy=!1,this.DataExpired=3600,this.Name={broadcast:"broadcast-list",target:"target-list",instance:"inst-list"},this.Preq={},this.Com={url:{def:"e/broadcast/",target:"e/target/",instance:"e/instance/"}},this.Selected={}}ngOnInit(){this.loadInstance(()=>{this.core.sharing("SharedData",{preq:this.Preq})}),window.onbeforeunload=()=>this.ngOnDestroy()}ngOnDestroy(){if(this.core.stopAktif(),Object.keys(this.AllSub).length>0)for(let t in this.AllSub)this.AllSub[t]&&this.AllSub[t].unsubscribe()}sideHide(){this.core.sharing("SideHide",2)}SelectInstance(t){this.core.setLS("SelectedInstance",t),this.initializeWA(t)}openInstance(t){1==t.running?this.core.OpenConfirm({title:this.core.translatePipe("wmu.alert.open.title"),html:this.core.translatePipe("wmu.alert.open.msg"),confirmText:this.core.translatePipe("wmu.alert.open.ok"),cancelText:this.core.translatePipe("wmu.alert.open.cancel")},e=>{e.value&&this.SelectInstance(t)}):this.core.OpenAlert({title:this.core.translatePipe("wmu.alert.notrun.title"),msg:this.core.translatePipe("wmu.alert.notrun.msg")})}loadInstance(t){this.core.getStorage({id:this.Name.instance,isjson:!0}).then(e=>{if(e)if(e.data){var i=[];for(let t of e.data)if("demo"!=t.insid){if(t.info)try{t.info=JSON.parse(t.info)}catch(n){}i.push(t)}this.Preq.instance=i,t&&t()}else this.execLoadInstance(t);else this.execLoadInstance(t)})}execLoadInstance(t){if(this.Busy)return!1;this.Busy=!0,this.core.Do(this.Com.url.instance+"data",{}).subscribe(e=>{if(e&&e.data){var i={data:e.data,stamp:l()(new Date)};this.core.setStorage({id:this.Name.instance,isjson:!0},i).then(()=>{var i=[];for(let t of e.data)e.data.length>1&&"demo"==t.insid||(t.info&&(t.info=JSON.parse(t.info)),i.push(t));this.Preq.instance=i,this.Busy=!1,t&&t()})}else this.Busy=!1,t&&t()},e=>{this.Busy=!1,t&&t()})}initializeWA(t){var e=this;return(0,n.Z)(function*(){let i=["pro","exe"],s=!1;for(let e of i)if(e==t.subsid_name){s=!0;break}if(!s)return void e.core.OpenAlert({header:e.core.translatePipe("wmu.alert.invalid_pkg.header"),msg:e.core.translatePipe("wmu.alert.invalid_pkg.msg")});e.core.ShowLoader();const o=yield e.core.FS.collection(t.insid+"-general").doc("downloadchat");yield o.get().subscribe(function(){var i=(0,n.Z)(function*(i){let s=!1;if(i.data()&&i.data().data){let t=i.data(),e=l().unix(t.data);l()(new Date).diff(e,"hours")>=24&&(s=!0)}else yield o.set({data:l()().unix()}),s=!0;const c=yield e.core.FS.collection(t.insid+"-chat-list",t=>t.limit(10));e.AllSub.getChatList=yield c.get().subscribe(function(){var i=(0,n.Z)(function*(i){let o=i.docs.map(t=>t.data());if(o.length>0&&!s)return o=a().orderBy(o,["timestamp",["desc"]]),void e.core.getStorage({id:"chat-list-"+t.insid,isjson:!0}).then(function(){var i=(0,n.Z)(function*(i){if(i&&i.length>0)if(i.length>o.length&&o.length<10)e.setChat(t,o,()=>{e.activateWA(t)});else{let n=[];for(let t of o)t.timestamp&&(n.push(t),i=a().filter(i,e=>e.id._serialized!=t.id._serialized));i=[...n,...i],i=a().orderBy(i,["timestamp"],["desc"]),e.setChat(t,i,()=>{e.activateWA(t)})}else yield e.core.FS.collection(t.insid+"-chat-list",t=>t.limit(100).orderBy("timestamp","desc")).get().subscribe(function(){var i=(0,n.Z)(function*(i){o=i.docs.map(t=>t.data()),o=a().orderBy(o,["timestamp"],["desc"]),console.log("current",o),e.setChat(t,o,()=>{e.activateWA(t)})});return function(t){return i.apply(this,arguments)}}())});return function(t){return i.apply(this,arguments)}}());var l={phone:t.info.me._serialized,cmd:"initlist",time:null};e.Command=yield e.core.FS.collection(t.insid+"-command",e=>e.where("phone","==",t.info.me._serialized).limit(1)).doc(t.info.me._serialized),yield e.Command.set(l),e.AllSub.getChatListNew=yield e.core.FS.collection(t.insid+"-chat-list",t=>t.limit(100).orderBy("timestamp","desc")).snapshotChanges().subscribe(i=>{if(i.length>0){let n=i.map(t=>t.payload.doc.data());n=a().orderBy(n,["timestamp"],["desc"]),e.core.sharingTemp="loadNewList",e.setChat(t,n,()=>{e.activateWA(t)})}})});return function(t){return i.apply(this,arguments)}}())});return function(t){return i.apply(this,arguments)}}())})()}activateWA(t){if(this.core.stopAktif(),this.sideHide(),this.Selected=t,this.core.sharing("SelectInstance",t),Object.keys(this.AllSub).length>0)for(let e in this.AllSub)this.AllSub[e]&&this.AllSub[e].unsubscribe();this.router.navigate(["/multiuser/"+t.insid]),this.core.HideLoader()}setChat(t,e,i){this.core.setStorage({id:"chat-list-"+t.insid,isjson:!0},e).then(()=>{i()})}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(r.Q),c.Y36(d.F0))},t.\u0275cmp=c.Xpm({type:t,selectors:[["wa-instance-list"]],decls:11,vars:1,consts:[[1,"relative","flex","flex-auto","w-full","bg-card","dark:bg-transparent","h-full"],[1,"relative","flex","flex-auto","flex-col","w-full","min-w-0","lg:min-w-80","lg:max-w-80","border-r","z-10"],[1,"relative","flex","flex-0","items-center","justify-between","h-16","px-4","border-b","bg-gray-200","text-gray-700","dark:bg-transparent"],[1,"flex","items-center"],[1,"ml-2","font-semibold","uppercase"],["mat-icon-button","",3,"click"],["svgIcon","heroicons_outline:chevron-left",1,"icon-size-5"],[1,"overflow-y-auto"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"relative","flex","flex-row","border-t","first:border-0","hover:bg-hover","cursor-pointer","p-5","px-6",3,"ngClass","click"],[1,"flex","flex-col","flex-auto"],[1,"text-xs"],[1,"flex"],[1,"icon-size-12","my-auto",3,"ngClass","svgIcon"],[1,"font-semibold","mt-2"],[1,"flex","flex-row","mt-2","italic","text-sm","text-red-700"],["svgIcon","heroicons_outline:information-circle",1,"icon-size-5","mr-2","text-red-700"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"div",3),c.TgZ(4,"div",4),c._uU(5," Instance List "),c.qZA(),c.qZA(),c.TgZ(6,"div",3),c.TgZ(7,"a",5),c.NdJ("click",function(){return e.sideHide()}),c._UZ(8,"mat-icon",6),c.qZA(),c.qZA(),c.qZA(),c.TgZ(9,"div",7),c.YNc(10,b,2,1,"ng-container",8),c.qZA(),c.qZA(),c.qZA()),2&t&&(c.xp6(10),c.Q6J("ngIf",(null==e.Preq||null==e.Preq.instance?null:e.Preq.instance.length)>0))},directives:[h.zs,u.Hw,g.O5,g.sg,g.mk,m.oO],pipes:[f.X$],encapsulation:2}),t})()},55498:(t,e,i)=>{"use strict";i.d(e,{N:()=>a});var n=i(37716),s=i(76627);let a=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=n.Xpm({type:t,selectors:[["wa-no-instance"]],decls:5,vars:1,consts:[[1,"flex","flex-col","flex-auto","overflow-y-auto","lg:overflow-hidden","bg-card","dark:bg-default","h-full"],[1,"flex","flex-col","flex-auto","items-center","justify-center","bg-gray-100","dark:bg-transparent","h-full"],[1,"icon-size-24",3,"svgIcon"],[1,"mt-4","text-2xl","font-semibold","tracking-tight","text-secondary"]],template:function(t,e){1&t&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n._UZ(2,"mat-icon",2),n.TgZ(3,"div",3),n._uU(4," Please Select Instance to Start Whatsapp Web Chat "),n.qZA(),n.qZA(),n.qZA()),2&t&&(n.xp6(2),n.Q6J("svgIcon","wa"))},directives:[s.Hw],encapsulation:2}),t})()},15472:(t,e,i)=>{"use strict";i.d(e,{V:()=>c});var n=i(39895),s=i(96457),a=(i(42795),i(55498),i(37624),i(23402),i(47908)),o=i(37716);const l=[{path:"",children:[{path:"",component:s.z},{path:":insid",component:a.i}]}];let c=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[n.Bz.forChild(l)],n.Bz]}),t})()},96457:(t,e,i)=>{"use strict";i.d(e,{z:()=>u});var n=i(37716),s=i(42448),a=i(38583),o=i(88030),l=i(51095),c=i(76627),r=i(42795),d=i(55498);function h(t,e){1&t&&n._UZ(0,"wa-no-instance",9)}let u=(()=>{class t{constructor(t){this.core=t,this.AllSub={},this.SideShow=!0,this.SelectedInstance={},this.SharedData={},this.subSharing()}subSharing(){this.AllSub.SideHide=this.core.getSharing("SideHide").subscribe(t=>{t&&(this.SideShow=1==t,this.core.sharing("SideHide",null))}),this.AllSub.SelectInstance=this.core.getSharing("SelectInstance").subscribe(t=>{if(t){let e=10;t.id!=this.SelectedInstance.id&&(this.SelectedInstance={},e=1e3),setTimeout(()=>{this.SelectedInstance=t,this.core.sharing("SelectInstance",null)},e)}}),this.AllSub.SharedData=this.core.getSharing("SharedData").subscribe(t=>{t&&t.preq&&(this.SharedData.preq=t.preq)})}ngOnInit(){this.core.setTitle("Whatsapp Multiuser"),window.onbeforeunload=()=>this.ngOnDestroy()}ngOnDestroy(){if(this.core.stopAktif(),Object.keys(this.AllSub).length>0)for(let t in this.AllSub)this.AllSub[t]&&this.AllSub[t].unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(s.Q))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-wamulti-users"]],decls:9,vars:3,consts:[[1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-hidden"],[1,"flex-auto","h-fullx"],[1,"flex","flex-col","overflow-hidden","h-full"],[1,"flex","flex-auto","overflow-hidden","border","h-fullx","relative"],[1,"absolute","left-0","top-0","p-1","bg-primary",2,"z-index","2","height","72px",3,"ngClass","click"],["mat-icon-button","",1,"mt-3"],["svgIcon","heroicons_outline:chevron-right",1,"icon-size-5","text-white"],[1,"absolute","left-0","h-full",2,"z-index","1",3,"ngClass"],["class","ml-80 w-full",4,"ngIf"],[1,"ml-80","w-full"]],template:function(t,e){1&t&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n.TgZ(2,"div",2),n.TgZ(3,"div",3),n.TgZ(4,"div",4),n.NdJ("click",function(){return e.SideShow=!0}),n.TgZ(5,"a",5),n._UZ(6,"mat-icon",6),n.qZA(),n.qZA(),n._UZ(7,"wa-instance-list",7),n.YNc(8,h,1,0,"wa-no-instance",8),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&t&&(n.xp6(4),n.Q6J("ngClass",e.SideShow?"invisible":"visible"),n.xp6(3),n.Q6J("ngClass",e.SideShow?"visible":"invisible"),n.xp6(1),n.Q6J("ngIf",!(null!=e.SelectedInstance&&e.SelectedInstance.id)))},directives:[a.mk,o.oO,l.zs,c.Hw,r.l,a.O5,d.N],styles:["wa-conversation[_ngcontent-%COMP%]   .chat-container[_ngcontent-%COMP%]{background:#efe7dd url(/assets/4e765036-1639-11e6-9201-67e728e86f39.jpg) repeat}wa-conversation[_ngcontent-%COMP%]   .bg-green-wa[_ngcontent-%COMP%]{background-color:#dcf8c6}wa-conversation[_ngcontent-%COMP%]   .text-green-wa[_ngcontent-%COMP%]{color:#dcf8c6}wa-conversation[_ngcontent-%COMP%]   .chat-item[_ngcontent-%COMP%]{min-width:75px!important}wa-conversation[_ngcontent-%COMP%]   .img-chat[_ngcontent-%COMP%]{display:inline-block;margin:0 -5px;background-size:cover;background-position:50%;background-repeat:no-repeat;width:200px;height:250px;max-width:300px;max-height:375px}wa-conversation[_ngcontent-%COMP%]   .img-horizontal[_ngcontent-%COMP%]{width:350px!important;height:200px!important}wa-conversation[_ngcontent-%COMP%]   .img-vertical[_ngcontent-%COMP%]{width:200px!important;height:300px!important}"]}),t})()},90942:(t,e,i)=>{"use strict";i.r(e),i.d(e,{WAMultiUsersModule:()=>r});var n=i(38583),s=i(15472),a=i(44466),o=i(49616),l=i(71386),c=i(37716);i(96457),i(42795),i(47908),i(37624),i(23402);let r=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[n.ez,s.V,a.m,o.m,l.Cl]]}),t})()}}]);