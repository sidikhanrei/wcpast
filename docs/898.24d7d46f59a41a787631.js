(self.webpackChunkwachatpro_webclient=self.webpackChunkwachatpro_webclient||[]).push([[898],{93409:(t,e,i)=>{"use strict";i.d(e,{uC:()=>o});var a=i(39895),s=i(65372),l=(i(40190),i(21953),i(37716));const r=[{path:"",children:[{path:"",component:s.M}]}];let o=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[a.Bz.forChild(r)],a.Bz]}),t})()},65372:(t,e,i)=>{"use strict";i.d(e,{M:()=>o});var a=i(37716),s=i(42448),l=i(21953),r=i(40190);let o=(()=>{class t{constructor(t){this.core=t}ngOnInit(){this.core.setTitle("Broadcast")}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(s.Q))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-broadcast"]],decls:6,vars:0,consts:[[1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-hidden"],[1,"flex-auto","h-full"],[1,"flex","flex-col","overflow-hidden","h-full"],[1,"flex","flex-auto","overflow-hidden","border","h-full"],[1,"h-full","w-full","border-l"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"div",2),a.TgZ(3,"div",3),a._UZ(4,"broadcast-list"),a._UZ(5,"broadcast-detail",4),a.qZA(),a.qZA(),a.qZA(),a.qZA())},directives:[l.v,r.W],styles:[""]}),t})()},99898:(t,e,i)=>{"use strict";i.r(e),i.d(e,{BroadcastModule:()=>d});var a=i(38583),s=i(93409),l=i(44466),r=i(49616),o=i(71386),n=i(37716);i(65372),i(21953);let d=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[a.ez,s.uC,l.m,r.m,o.Cl]]}),t})()},40190:(t,e,i)=>{"use strict";i.d(e,{W:()=>l});var a=i(37716),s=i(76627);let l=(()=>{class t{ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Xpm({type:t,selectors:[["broadcast-detail"]],decls:5,vars:1,consts:[[1,"flex","flex-col","flex-auto","overflow-y-auto","lg:overflow-hidden","bg-card","dark:bg-default","h-full"],[1,"flex","flex-col","flex-auto","items-center","justify-center","bg-gray-100","dark:bg-transparent","h-full"],[1,"icon-size-24",3,"svgIcon"],[1,"mt-4","text-2xl","font-semibold","tracking-tight","text-secondary"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a._UZ(2,"mat-icon",2),a.TgZ(3,"div",3),a._uU(4," Select broadcast to view detail "),a.qZA(),a.qZA(),a.qZA()),2&t&&(a.xp6(2),a.Q6J("svgIcon","iconsmind:blinklist"))},directives:[s.Hw],encapsulation:2}),t})()},21953:(t,e,i)=>{"use strict";i.d(e,{v:()=>Z});var a=i(71386),s=i(23815),l=i.n(s),r=i(16738),o=i.n(r),n=i(37716),d=i(42448),c=i(38583),u=i(12178),f=i(29790);function h(t,e){1&t&&n._UZ(0,"mat-progress-bar",7),2&t&&n.Q6J("mode","indeterminate")}function g(t,e){if(1&t&&(n.TgZ(0,"div",22),n.TgZ(1,"div",14),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"div",23),n._uU(5),n.qZA(),n.qZA()),2&t){const t=n.oxw().$implicit,e=n.oxw(2);n.xp6(2),n.hij(" ",n.lcZ(3,2,"broadcast.detail.status.wait")," "),n.xp6(3),n.hij(" ",e.formatDate(null==t?null:t.jadwal_time)," ")}}function m(t,e){1&t&&(n.TgZ(0,"div",22),n.TgZ(1,"div",14),n._uU(2," Status "),n.qZA(),n.TgZ(3,"div",23),n._uU(4," In Progress "),n.qZA(),n.qZA())}function x(t,e){if(1&t&&(n.TgZ(0,"div",22),n.TgZ(1,"div",14),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"div",24),n._uU(5),n.qZA(),n.qZA()),2&t){const t=n.oxw().$implicit,e=n.oxw(2);n.xp6(2),n.hij(" ",n.lcZ(3,2,"broadcast.detail.finish_date")," "),n.xp6(3),n.hij(" ",e.formatDate(null==t?null:t.finish_date)," ")}}function v(t,e){if(1&t&&(n.ynx(0),n.TgZ(1,"a",11),n.TgZ(2,"div",12),n.TgZ(3,"div",13),n.TgZ(4,"div"),n.TgZ(5,"div",14),n._uU(6),n.qZA(),n.TgZ(7,"div",15),n._uU(8," 2021-08-02 23:41 "),n.qZA(),n.qZA(),n.TgZ(9,"div",16),n.TgZ(10,"div",17),n.TgZ(11,"div",18),n.TgZ(12,"div",14),n._uU(13," Broadcast Type "),n.qZA(),n.TgZ(14,"div",15),n._uU(15),n.qZA(),n.qZA(),n.YNc(16,g,6,4,"div",19),n.YNc(17,m,5,0,"div",19),n.YNc(18,x,6,4,"div",19),n.qZA(),n.qZA(),n.TgZ(19,"div",20),n.TgZ(20,"div",21),n._uU(21," Total Target "),n.qZA(),n.TgZ(22,"div"),n._uU(23),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.BQk()),2&t){const t=e.$implicit;n.xp6(6),n.hij(" ",t.alias?t.alias:t.insid," "),n.xp6(9),n.hij(" ",1==t.delay?"Smart Delay":"Manual Timer"," "),n.xp6(1),n.Q6J("ngIf",!t.finish_date&&!t.nextrun_date&&2==t.jadwal),n.xp6(1),n.Q6J("ngIf",!t.finish_date&&t.nextrun_date),n.xp6(1),n.Q6J("ngIf",t.finish_date),n.xp6(5),n.hij(" ",null==t.target_data?null:t.target_data.length," Target ")}}function p(t,e){if(1&t&&(n.TgZ(0,"cdk-virtual-scroll-viewport",8),n.TgZ(1,"div",9),n.YNc(2,v,24,6,"ng-container",10),n.qZA(),n.qZA()),2&t){const t=n.oxw();n.Q6J("itemSize",0),n.xp6(2),n.Q6J("cdkVirtualForOf",t.List)}}let Z=(()=>{class t{constructor(t,e){this.core=t,this.zone=e,this.Test=[],this.AllSub={},this.Ready=!1,this.Any={},this.Busy=!1,this.DataExpired=3600,this.Name={broadcast:"broadcast-list"},this.domList=100,this.Limit=100,this.Count=0,this.Com={url:"e/broadcast/"},this.AllList={},this.List=[]}ngOnInit(){for(let t=0;t<=10;t++)this.Test.push(t);this.loadData()}ngOnDestroy(){if(Object.keys(this.AllSub).length>0)for(let t in this.AllSub)this.AllSub[t]&&this.AllSub[t].unsubscribe()}formatDate(t){return o()(t).format("YYYY-MM-DD HH:mm")}loadData(t=!1){this.Busy||(this.Busy=!0,clearTimeout(this.delayLoadData),this.delayLoadData=setTimeout(()=>{let e=this.Name.broadcast;this.AllList[e]||(this.AllList[e]=[]),t?this.execLoadData(t):this.core.getStorage({id:e,isjson:!0}).then(e=>{var i;if(e){var a=e.data,s=o()(e.stamp);o()(new Date).diff(s,"seconds")>this.DataExpired&&(null===(i=this.List)||void 0===i?void 0:i.length)<=0?this.execLoadData(t):this.zone.run(()=>{let t=JSON.parse(JSON.stringify(a.slice(this.List.length,this.List.length+this.domList)));for(let e of t)e.target_data&&this.core.isJSON(e.target_data)&&(e.target_data=JSON.parse(e.target_data));this.List=this.List.length>0?[...this.List,...t]:t,t.length<this.domList&&(this.InfiniteStop=!0),this.List.length<=0&&t.length<=0&&(this.DataUnavailable=!0),this.Busy=!1})}else this.execLoadData(t)})},100))}execLoadData(t){clearTimeout(this.delayLoadData),this.delayLoadData=setTimeout(()=>{this.core.Do(this.Com.url+"data",{}).subscribe(t=>{this.Busy=!1,t&&t.data?this.zone.run(()=>{var e=t.data;let i=JSON.parse(JSON.stringify(e.slice(0,this.domList)));for(let t of i)t.target_data&&this.core.isJSON(t.target_data)&&(t.target_data=JSON.parse(t.target_data));this.List=this.List.length>0?[...this.List,...i]:i,i.length<this.domList&&(this.InfiniteStop=!0),i.length<=0&&(this.DataUnavailable=!0),this.updateStorage(e,this.Name.broadcast)}):(this.InfiniteStop=!0,this.List.length<=0&&(this.DataUnavailable=!0))},t=>{this.Busy=!1})})}updateStorage(t,e=this.Name.broadcast){this.AllList[e]||(this.AllList[e]=[]),this.core.getStorage({id:e,isjson:!0}).then(i=>{var a;if(i){var s=i.data,r=o()(i.stamp);if(o()(new Date).diff(r,"seconds")>this.DataExpired&&(null===(a=this.List)||void 0===a?void 0:a.length)>0)this.core.setStorage({id:e,isjson:!0},{data:t,stamp:o()(new Date)});else{var n=[...s,...t],d=l().uniqBy(n,"number");this.AllList[e]=d,this.core.setStorage({id:e,isjson:!0},{data:d,stamp:r})}}else this.core.setStorage({id:e,isjson:!0},{data:t,stamp:o()(new Date)}),this.AllList[e]=t})}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(d.Q),n.Y36(n.R0b))},t.\u0275cmp=n.Xpm({type:t,selectors:[["broadcast-list"]],viewQuery:function(t,e){if(1&t&&n.Gf(a.N7,5),2&t){let t;n.iGM(t=n.CRH())&&(e.virtualScroll=t.first)}},decls:9,vars:2,consts:[[1,"relative","flex","flex-auto","w-full","bg-card","dark:bg-transparent","h-full"],[1,"relative","flex","flex-auto","flex-col","w-full","min-w-0","lg:min-w-90","lg:max-w-90","border-r","z-10"],[1,"relative","flex","flex-0","items-center","justify-between","h-16","px-4","border-b","bg-primary-800","text-gray-50","dark:bg-transparent"],[1,"flex","items-center"],[1,"ml-2","font-semibold","uppercase"],["class","absolute inset-x-0 bottom-0 h-0.5","color","accent",3,"mode",4,"ngIf"],["customVirtualScrollStrategy","","class","virtual-container","minBufferPx","1000","maxBufferPx","1500",3,"itemSize",4,"ngIf"],["color","accent",1,"absolute","inset-x-0","bottom-0","h-0.5",3,"mode"],["customVirtualScrollStrategy","","minBufferPx","1000","maxBufferPx","1500",1,"virtual-container",3,"itemSize"],[1,"overflow-y-auto"],[4,"cdkVirtualFor","cdkVirtualForOf"],[1,"relative","flex","border-t","first:border-0","hover:bg-hover","cursor-pointer"],[1,"flex","flex-col","items-start","justify-start","w-full","py-3","pr-4","pl-5","border-l-4","border-transparent"],[1,"flex","flex-col","w-full"],[1,"mr-2","font-semibold"],[1,"text-sm"],[1,"mt-4"],[1,"flex","flex-auto","flex-row"],[1,"flex","flex-auto","flex-col","mr-2"],["class","flex flex-auto flex-col",4,"ngIf"],[1,"mt-2"],[1,"mr-2","text-sm","font-semibold"],[1,"flex","flex-auto","flex-col"],[1,"text-sm","text-yellow-600"],[1,"text-sm","text-blue-600"]],template:function(t,e){1&t&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n.TgZ(2,"div",2),n.TgZ(3,"div",3),n.TgZ(4,"div",4),n._uU(5," Broadcast List "),n.qZA(),n.qZA(),n._UZ(6,"div",3),n.YNc(7,h,1,1,"mat-progress-bar",5),n.qZA(),n.YNc(8,p,3,2,"cdk-virtual-scroll-viewport",6),n.qZA(),n.qZA()),2&t&&(n.xp6(7),n.Q6J("ngIf",e.Busy),n.xp6(1),n.Q6J("ngIf",(null==e.List?null:e.List.length)>0))},directives:[c.O5,u.pW,a.N7,a.xd,a.x0],pipes:[f.X$],encapsulation:2}),t})()}}]);